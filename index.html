<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cosmic Cow Hunt</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #001f3f;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(to bottom, #001f3f, #0074D9);
      border: 4px solid #00aaff;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-family: 'Courier New', Courier, monospace;
      font-size: 20px;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="score">Score: 0</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Установить размеры экрана
canvas.width = window.innerWidth * 0.9;
canvas.height = window.innerHeight * 0.9;

let score = 0;
let cows = [];

const cowSize = 60;
const cowSpeed = 2;
const shootCooldown = 500; // ms

let lastShotTime = 0;

class Cow {
  constructor() {
    this.x = Math.random() * (canvas.width - cowSize);
    this.y = -cowSize;
    this.vx = (Math.random() - 0.5) * 2;
    this.vy = cowSpeed + Math.random();
    this.frame = 0;
    this.alive = true;
  }

  update() {
    if (!this.alive) return;
    this.x += this.vx;
    this.y += this.vy;
    this.frame = (this.frame + 0.2) % 4;
    if (this.y > canvas.height) {
      this.alive = false;
    }
  }

  draw() {
    if (!this.alive) return;
    const frameIndex = Math.floor(this.frame);
    ctx.save();
    ctx.translate(this.x + cowSize / 2, this.y + cowSize / 2);

    // Тело коровы
    ctx.fillStyle = "white";
    ctx.fillRect(-cowSize / 2, -cowSize / 2, cowSize, cowSize / 2);

    // Голова в шлеме
    ctx.beginPath();
    ctx.arc(0, -cowSize / 2.5, cowSize / 3, 0, Math.PI * 2);
    ctx.fillStyle = "#888";
    ctx.fill(); // Шлем
    ctx.strokeStyle = "#000";
    ctx.stroke();

    // Рожки
    ctx.beginPath();
    ctx.moveTo(-cowSize / 8, -cowSize);
    ctx.lineTo(-cowSize / 10, -cowSize / 2.5);
    ctx.moveTo(cowSize / 8, -cowSize);
    ctx.lineTo(cowSize / 10, -cowSize / 2.5);
    ctx.strokeStyle = "brown";
    ctx.lineWidth = 3;
    ctx.stroke();

    // Глаза
    ctx.fillStyle = "white";
    ctx.fillRect(-cowSize / 8 - 5, -cowSize / 2.8, 5, 5);
    ctx.fillRect(cowSize / 8, -cowSize / 2.8, 5, 5);
    ctx.fillStyle = "black";
    ctx.fillRect(-cowSize / 8 - 3, -cowSize / 2.8 + 1, 3, 3);
    ctx.fillRect(cowSize / 8 + 2, -cowSize / 2.8 + 1, 3, 3);

    // Нос
    ctx.fillStyle = "brown";
    ctx.beginPath();
    ctx.ellipse(0, -cowSize / 3.5, 6, 4, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(-2, -cowSize / 3.5, 1, 0, Math.PI * 2);
    ctx.arc(2, -cowSize / 3.5, 1, 0, Math.PI * 2);
    ctx.fill();

    // Анимация ног
    const legOffset = Math.sin(frameIndex) * 3;
    ctx.fillStyle = "white";
    ctx.fillRect(-cowSize / 3, cowSize / 6, 8, 10); // Левая передняя
    ctx.fillRect(cowSize / 3 - 8, cowSize / 6, 8, 10); // Правая передняя
    ctx.fillRect(-cowSize / 3, cowSize / 2 - 5 + legOffset, 8, 10); // Левая задняя
    ctx.fillRect(cowSize / 3 - 8, cowSize / 2 - 5 + legOffset, 8, 10); // Правая задняя

    ctx.restore();
  }

  isHit(x, y) {
    return (
      x >= this.x &&
      x <= this.x + cowSize &&
      y >= this.y &&
      y <= this.y + cowSize
    );
  }
}

function spawnCow() {
  cows.push(new Cow());
}

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Звёзды
  for (let i = 0; i < 100; i++) {
    ctx.fillStyle = "white";
    ctx.fillRect(Math.random() * canvas.width, Math.random() * canvas.height, 1, 1);
  }

  cows.forEach((cow) => {
    cow.update();
    cow.draw();
  });

  // Очистить мёртвых коров
  cows = cows.filter((cow) => cow.alive);

  requestAnimationFrame(update);
}

function shoot(x, y) {
  const now = Date.now();
  if (now - lastShotTime < shootCooldown) return;
  lastShotTime = now;

  cows.forEach((cow) => {
    if (cow.isHit(x, y)) {
      cow.alive = false;
      score++;
      document.getElementById("score").innerText = `Score: ${score}`;
    }
  });
}

canvas.addEventListener("click", (e) => {
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  shoot(x, y);
});

// Мобильные устройства (Telegram Web App)
canvas.addEventListener("touchstart", (e) => {
  const touch = e.touches[0];
  const rect = canvas.getBoundingClientRect();
  const x = touch.clientX - rect.left;
  const y = touch.clientY - rect.top;
  shoot(x, y);
});

// Периодическое появление коров
setInterval(spawnCow, 1000);

update();
</script>
</body>
</html>