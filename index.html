<!DOCTYPE html>
<html>
<head>
    <title>Cow Hunt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
        #menu, #leaderboard { 
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            display: none;
        }
        button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.2em;
            background: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover { background: #45a049; }
        #hearts { position: absolute; top: 10px; left: 10px; }
        #timer { position: absolute; top: 10px; right: 10px; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    
    <div id="menu">
        <h1>Cow Hunt</h1>
        <button onclick="startGame()">Start Game</button>
        <button onclick="showLeaderboard()">Leaderboard</button>
    </div>
    
    <div id="leaderboard">
        <h1>Top Scores</h1>
        <div id="scoresList"></div>
        <button onclick="hideLeaderboard()">Back</button>
    </div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const gameState = {
    menu: true,
    playing: false,
    leaderboard: false,
    score: 0,
    lives: 3,
    timeLeft: 60,
    lastShot: 0,
    shotCooldown: 500
};

const cows = [];
const explosions = [];
const bullets = [];

// Загрузка изображений
const cowImg = new Image();
cowImg.src = 'https://i.imgur.com/9uZJY7X.png'; // Пример спрайта коровы

const heartImg = new Image();
heartImg.src = 'https://i.imgur.com/4yD4t7y.png';

const bulletImg = new Image();
bulletImg.src = 'https://i.imgur.com/3z3X4yG.png';

// Функции отрисовки
function drawBackground() {
    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    gradient.addColorStop(0, '#1a0d4d');
    gradient.addColorStop(0.7, '#2c1a6d');
    gradient.addColorStop(1, '#4d268d');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Фиолетовый туман
    ctx.fillStyle = 'rgba(128, 0, 128, 0.3)';
    ctx.fillRect(0, canvas.height - 100, canvas.width, 100);
}

function drawUI() {
    // Сердца
    for(let i = 0; i < gameState.lives; i++) {
        ctx.drawImage(heartImg, 10 + i*40, 10, 32, 32);
    }
    
    // Таймер
    ctx.fillStyle = 'white';
    ctx.font = '30px Arial';
    ctx.fillText(gameState.timeLeft.toFixed(0), canvas.width - 100, 50);
    
    // Счет
    ctx.fillText('Score: ' + gameState.score, 10, canvas.height - 20);
}

// Обновление игры
function update() {
    if (!gameState.playing) return;
    
    // Обновление времени
    const now = Date.now();
    if(gameState.lastTime) {
        const delta = (now - gameState.lastTime) / 1000;
        gameState.timeLeft = Math.max(0, gameState.timeLeft - delta);
    }
    gameState.lastTime = now;
    
    // Создание коров
    if(Math.random() < 0.01) {
        cows.push({
            x: canvas.width,
            y: Math.random() * (canvas.height - 200) + 100,
            speedX: -2 - Math.random() * 3,
            speedY: Math.random() * 2 - 1,
            angle: 0
        });
    }
    
    // Обновление коров
    cows.forEach((cow, index) => {
        cow.x += cow.speedX;
        cow.y += Math.sin(cow.angle) * 2;
        cow.angle += 0.1;
        
        if(cow.x < -100) {
            cows.splice(index, 1);
            gameState.lives--;
            if(gameState.lives <= 0) endGame();
        }
    });
    
    // Обновление выстрелов
    bullets.forEach((bullet, index) => {
        bullet.x += bullet.speedX;
        bullet.y += bullet.speedY;
        
        // Проверка попаданий
        cows.forEach((cow, cIndex) => {
            const dx = cow.x - bullet.x;
            const dy = cow.y - bullet.y;
            if(Math.sqrt(dx*dx + dy*dy) < 50) {
                explosions.push({
                    x: cow.x,
                    y: cow.y,
                    time: Date.now()
                });
                cows.splice(cIndex, 1);
                bullets.splice(index, 1);
                gameState.score += 10;
            }
        });
        
        if(bullet.x < 0 || bullet.x > canvas.width || 
           bullet.y < 0 || bullet.y > canvas.height) {
            bullets.splice(index, 1);
        }
    });
    
    // Обновление взрывов
    explosions.forEach((exp, index) => {
        if(Date.now() - exp.time > 500) {
            explosions.splice(index, 1);
        }
    });
    
    if(gameState.timeLeft <= 0) endGame();
}

// Отрисовка
function render() {
    drawBackground();
    
    // Отрисовка коров
    cows.forEach(cow => {
        ctx.save();
        ctx.translate(cow.x, cow.y);
        ctx.rotate(Math.atan2(cow.speedY, cow.speedX));
        ctx.drawImage(cowImg, -50, -50, 100, 100);
        ctx.restore();
    });
    
    // Отрисовка выстрелов
    bullets.forEach(bullet => {
        ctx.drawImage(bulletImg, bullet.x - 10, bullet.y - 10, 20, 20);
    });
    
    // Отрисовка взрывов
    explosions.forEach(exp => {
        ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
        ctx.beginPath();
        ctx.arc(exp.x, exp.y, 30, 0, Math.PI*2);
        ctx.fill();
    });
    
    drawUI();
    
    requestAnimationFrame(render);
}

// Обработка кликов
canvas.addEventListener('click', (e) => {
    if(!gameState.playing || Date.now() - gameState.lastShot < gameState.shotCooldown) return;
    
    gameState.lastShot = Date.now();
    
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    const angle = Math.atan2(y - canvas.height/2, x - canvas.width/2);
    
    bullets.push({
        x: canvas.width/2,
        y: canvas.height/2,
        speedX: Math.cos(angle) * 10,
        speedY: Math.sin(angle) * 10
    });
});

// Управление состоянием игры
function startGame() {
    document.getElementById('menu').style.display = 'none';
    gameState.playing = true;
    gameState.score = 0;
    gameState.lives = 3;
    gameState.timeLeft = 60;
    cows.length = 0;
    bullets.length = 0;
    explosions.length = 0;
}

function endGame() {
    gameState.playing = false;
    updateLeaderboard();
    document.getElementById('menu').style.display = 'flex';
}

function showLeaderboard() {
    const scores = JSON.parse(localStorage.getItem('leaderboard')) || [];
    const list = document.getElementById('scoresList');
    list.innerHTML = scores.map(s => `<div>${s.name}: ${s.score}</div>`).join('');
    document.getElementById('menu').style.display = 'none';
    document.getElementById('leaderboard').style.display = 'flex';
}

function hideLeaderboard() {
    document.getElementById('leaderboard').style.display = 'none';
    document.getElementById('menu').style.display = 'flex';
}

function updateLeaderboard() {
    let scores = JSON.parse(localStorage.getItem('leaderboard')) || [];
    scores.push({name: 'Player', score: gameState.score});
    scores.sort((a, b) => b.score - a.score);
    scores = scores.slice(0, 10);
    localStorage.setItem('leaderboard', JSON.stringify(scores));
}

// Инициализация
function init() {
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
    
    render();
}

init();
</script>
</body>
</html>
