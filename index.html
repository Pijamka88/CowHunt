<!DOCTYPE html>
<html>
<head>
    <title>Cow Hunt</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(180deg, #1a1a1a 0%, #330033 100%);
            font-family: 'Arial', sans-serif;
            color: white;
            text-align: center;
        }

        #main-menu, #game, #leaderboard {
            display: none;
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .visible { display: block; }

        button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.2em;
            background: #660066;
            border: 2px solid #cc00cc;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: #993399;
        }

        #hud {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }

        #fog {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: linear-gradient(transparent 0%, rgba(102, 0, 102, 0.8) 100%);
            pointer-events: none;
        }

        .cow {
            position: absolute;
            width: 60px;
            height: 60px;
            background: url('https://raw.githubusercontent.com/Pijamka88/CowHunt/main/cow.png') center/contain no-repeat;
            transform-origin: center;
        }

        .explosion {
            position: absolute;
            width: 50px;
            height: 50px;
            background: url('https://raw.githubusercontent.com/Pijamka88/CowHunt/main/explosion.png') center/contain no-repeat;
            animation: explode 0.5s forwards;
        }

        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .shot {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff00ff;
            border-radius: 50%;
            animation: shot 0.3s forwards;
        }

        @keyframes shot {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.3); opacity: 0; }
        }

        #leaderboard table {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-collapse: collapse;
        }

        #leaderboard td {
            padding: 10px;
            border: 1px solid #cc00cc;
        }
    </style>
</head>
<body>
    <div id="main-menu" class="visible">
        <h1>COW HUNT</h1>
        <button onclick="startGame()">Играть</button>
        <button onclick="showLeaderboard()">Рейтинг</button>
        <button onclick="window.location.reload()">Выход</button>
    </div>

    <div id="game">
        <div id="hud">
            <div>SCORE: <span id="score">0</span></div>
            <div>LIVES: <span id="lives">❤❤❤</span></div>
            <div>TIME: <span id="timer">60</span></div>
        </div>
        <div id="fog"></div>
    </div>

    <div id="leaderboard">
        <button onclick="showMainMenu()">Назад</button>
        <table>
            <tr><th>Место</th><th>Имя</th><th>Очки</th></tr>
            <tbody id="leaderboard-body"></tbody>
        </table>
    </div>

    <audio id="deathSound" src="https://github.com/Pijamka88/CowHunt/raw/refs/heads/main/Death%20Cow.mp3"></audio>

    <script>
        const gameState = {
            cows: [],
            shots: [],
            explosions: [],
            score: 0,
            lives: 3,
            timeLeft: 60,
            lastShotTime: 0,
            reloadTime: 500,
            gameInterval: null,
            playerName: 'Player'
        };

        function showMainMenu() {
            document.querySelectorAll('.visible').forEach(el => el.classList.remove('visible'));
            document.getElementById('main-menu').classList.add('visible');
        }

        function showLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';
            
            leaderboard.sort((a, b) => b.score - a.score).slice(0, 10).forEach((entry, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${index+1}</td><td>${entry.name}</td><td>${entry.score}</td>`;
                tbody.appendChild(row);
            });
            
            document.querySelectorAll('.visible').forEach(el => el.classList.remove('visible'));
            document.getElementById('leaderboard').classList.add('visible');
        }

        function startGame() {
            document.querySelectorAll('.visible').forEach(el => el.classList.remove('visible'));
            document.getElementById('game').classList.add('visible');
            
            gameState.score = 0;
            gameState.lives = 3;
            gameState.timeLeft = 60;
            document.getElementById('score').textContent = 0;
            document.getElementById('lives').textContent = '❤'.repeat(3);
            
            gameState.gameInterval = setInterval(updateGame, 16);
            setTimeout(endGame, 60000);
            
            document.getElementById('game').addEventListener('click', shoot);
        }

        function updateGame() {
            updateCows();
            updateShots();
            updateExplosions();
            updateTimer();
        }

        function updateCows() {
            const gameArea = document.getElementById('game');
            
            // Remove off-screen cows
            gameState.cows = gameState.cows.filter(cow => cow.y < window.innerHeight + 100);
            
            // Spawn new cows
            if (Math.random() < 0.02) {
                const cow = document.createElement('div');
                cow.className = 'cow';
                cow.style.left = Math.random() * (window.innerWidth - 60) + 'px';
                cow.style.top = window.innerHeight + 'px';
                gameArea.appendChild(cow);
                
                gameState.cows.push({
                    element: cow,
                    x: parseFloat(cow.style.left),
                    y: parseFloat(cow.style.top),
                    speed: 2 + Math.random() * 3,
                    direction: Math.random() * 0.4 - 0.2
                });
            }
            
            // Update cow positions
            gameState.cows.forEach(cowData => {
                cowData.y -= cowData.speed;
                cowData.x += Math.sin(cowData.y / 50) * cowData.direction;
                cowData.element.style.transform = `translate(${cowData.x}px, ${cowData.y}px) rotate(${Math.sin(cowData.y/30)*10}deg)`;
            });
        }

        function updateShots() {
            gameState.shots = gameState.shots.filter(shot => {
                if (shot.y > 0) {
                    shot.y -= 10;
                    shot.element.style.transform = `translate(${shot.x}px, ${shot.y}px)`;
                    return true;
                } else {
                    shot.element.remove();
                    return false;
                }
            });
        }

        function updateExplosions() {
            gameState.explosions = gameState.explosions.filter(explosion => {
                if (explosion.time > 0) {
                    explosion.time -= 16;
                    return true;
                } else {
                    explosion.element.remove();
                    return false;
                }
            });
        }

        function updateTimer() {
            gameState.timeLeft = Math.max(0, gameState.timeLeft - 0.016);
            document.getElementById('timer').textContent = Math.ceil(gameState.timeLeft);
        }

        function shoot(event) {
            if (Date.now() - gameState.lastShotTime < gameState.reloadTime) return;
            
            gameState.lastShotTime = Date.now();
            
            const rect = document.getElementById('game').getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            const shot = document.createElement('div');
            shot.className = 'shot';
            shot.style.left = x - 5 + 'px';
            shot.style.top = y - 5 + 'px';
            document.getElementById('game').appendChild(shot);
            
            gameState.shots.push({
                element: shot,
                x: x - 5,
                y: y - 5
            });
            
            checkHits(x, y);
        }

        function checkHits(shotX, shotY) {
            gameState.cows.forEach((cowData, index) => {
                const cowRect = cowData.element.getBoundingClientRect();
                
                if (shotX > cowRect.left && 
                    shotX < cowRect.right &&
                    shotY > cowRect.top &&
                    shotY < cowRect.bottom) {
                    
                    gameState.score += 10;
                    document.getElementById('score').textContent = gameState.score;
                    
                    const explosion = document.createElement('div');
                    explosion.className = 'explosion';
                    explosion.style.left = cowRect.left + 'px';
                    explosion.style.top = cowRect.top + 'px';
                    document.getElementById('game').appendChild(explosion);
                    
                    gameState.explosions.push({ element: explosion, time: 500 });
                    gameState.cows.splice(index, 1);
                    cowData.element.remove();
                    
                    document.getElementById('deathSound').play();
                }
            });
        }

        function endGame() {
            clearInterval(gameState.gameInterval);
            document.getElementById('game').removeEventListener('click', shoot);
            
            // Save to leaderboard
            let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
            leaderboard.push({
                name: gameState.playerName,
                score: gameState.score
            });
            leaderboard.sort((a, b) => b.score - a.score);
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard.slice(0, 10)));
            
            alert(`Игра окончена! Ваш счет: ${gameState.score}`);
            showMainMenu();
        }
    </script>
</body>
</html>
