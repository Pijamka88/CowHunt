<!DOCTYPE html>
<html>
<head>
    <title>Cosmic Cow Hunt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        :root {
            --main-blue: #000033;
            --accent-blue: #3399ff;
            --pink-shadow: #ff66cc;
        }
        body {
            margin: 0;
            overflow: hidden;
            touch-action: none;
            background: var(--main-blue);
            font-family: 'Arial', sans-serif;
            color: white;
        }
        #gameCanvas {
            background: linear-gradient(to bottom, #000044, #000022);
            display: block;
        }
        .menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 102, 0.9);
            padding: 40px 60px;
            text-align: center;
            border-radius: 20px;
            border: 3px solid var(--accent-blue);
            box-shadow: 0 0 30px rgba(51, 153, 255, 0.5);
            min-width: 300px;
        }
        .menu h1 {
            color: white;
            margin: 0 0 25px;
            font-size: 2.5em;
            text-shadow: 3px 3px 0 var(--pink-shadow);
        }
        .menu button {
            padding: 15px 30px;
            font-size: 1.2em;
            margin: 10px;
            cursor: pointer;
            background: linear-gradient(to bottom, var(--accent-blue), #0066cc);
            border: none;
            color: white;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .menu button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--accent-blue);
        }
        #hud {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 51, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
        }
        .hud-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .hud-label {
            font-size: 12px;
            color: #a3d1ff;
            margin-bottom: 3px;
        }
        .hud-value {
            font-size: 18px;
            font-weight: bold;
        }
        .heart {
            color: #ff3366;
            font-size: 24px;
            margin: 0 3px;
            transition: all 0.3s;
        }
        .heart.burned {
            color: #444466;
        }
        #level {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 51, 0.8);
            padding: 5px 15px;
            border-radius: 15px;
        }
        .reloading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.5);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div id="mainMenu" class="menu">
        <h1>COSMIC COW HUNT</h1>
        <button onclick="startGame()">START GAME</button>
        <button onclick="showInstructions()">INSTRUCTIONS</button>
    </div>

    <div id="hud">
        <div class="hud-item">
            <div class="hud-label">SCORE</div>
            <div class="hud-value" id="score">0</div>
        </div>
        <div class="hud-item">
            <div class="hud-label">LIVES</div>
            <div id="hearts">♥♥♥</div>
        </div>
        <div class="hud-item">
            <div class="hud-label">AMMO</div>
            <div class="hud-value" id="ammo">5</div>
        </div>
    </div>

    <div id="level">LEVEL 1</div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const COW_WIDTH = 80;
        const COW_HEIGHT = 40;
        let gameState = {
            active: false,
            cows: [],
            level: 1,
            score: 0,
            lives: 3,
            ammo: 5,
            reloading: false
        };

        class CosmicCow {
            constructor() {
                this.x = Math.random() < 0.5 ? -COW_WIDTH : canvas.width;
                this.y = Math.random() * (canvas.height - 100) + 50;
                this.speed = 2 + gameState.level * 0.3;
                this.health = 1;
                this.frame = 0;
                this.direction = this.x < 0 ? 1 : -1;
                this.legPhase = Math.random() * Math.PI * 2;
            }

            update() {
                this.x += this.speed * this.direction;
                this.legPhase += 0.1;
                
                if (this.x < -COW_WIDTH || this.x > canvas.width + COW_WIDTH) {
                    this.health = 0;
                }
            }

            draw() {
                ctx.save();
                if (this.direction === -1) {
                    ctx.translate(this.x + COW_WIDTH/2, this.y);
                    ctx.scale(-1, 1);
                } else {
                    ctx.translate(this.x - COW_WIDTH/2, this.y);
                }

                // Body
                ctx.fillStyle = this.health > 0 ? '#ffffff' : '#666666';
                ctx.beginPath();
                ctx.roundRect(-COW_WIDTH/2, -COW_HEIGHT/2, COW_WIDTH, COW_HEIGHT, 10);
                ctx.fill();

                // Head
                ctx.beginPath();
                ctx.arc(0, 0, 20, 0, Math.PI * 2);
                ctx.fill();

                // Eyes
                const eyeY = -5;
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(-8, eyeY, 6, 0, Math.PI * 2);
                ctx.arc(8, eyeY, 6, 0, Math.PI * 2);
                ctx.fill();

                ctx.fillStyle = '#333';
                ctx.beginPath();
                ctx.arc(-8 + Math.cos(this.frame*0.1)*2, eyeY, 3, 0, Math.PI * 2);
                ctx.arc(8 + Math.cos(this.frame*0.1)*2, eyeY, 3, 0, Math.PI * 2);
                ctx.fill();

                // Nose
                ctx.fillStyle = '#ffe0b2';
                ctx.beginPath();
                ctx.arc(0, 10, 6, 0, Math.PI * 2);
                ctx.fill();

                // Nostrils
                ctx.fillStyle = '#333';
                ctx.beginPath();
                ctx.arc(-3, 10, 1.5, 0, Math.PI * 2);
                ctx.arc(3, 10, 1.5, 0, Math.PI * 2);
                ctx.fill();

                // Legs
                const legPositions = [-30, -10, 10, 30];
                legPositions.forEach(pos => {
                    const legHeight = 20 + Math.sin(this.legPhase + pos/10) * 5;
                    ctx.fillStyle = '#333';
                    ctx.fillRect(pos - 5, COW_HEIGHT/2 - 10, 10, legHeight);
                    ctx.fillRect(pos - 5, COW_HEIGHT/2 - 10 + legHeight, 10, 5);
                });

                // Horns
                ctx.strokeStyle = '#ffcc99';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(-15, -25);
                ctx.lineTo(-25, -35);
                ctx.moveTo(15, -25);
                ctx.lineTo(25, -35);
                ctx.stroke();

                ctx.restore();
                this.frame++;
            }
        }

        function gameLoop() {
            if (!gameState.active) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update and draw cows
            gameState.cows.forEach((cow, index) => {
                cow.update();
                cow.draw();
                if (cow.health <= 0) {
                    gameState.cows.splice(index, 1);
                }
            });

            requestAnimationFrame(gameLoop);
        }

        function spawnCow() {
            if (gameState.cows.length < 3 + gameState.level) {
                gameState.cows.push(new CosmicCow());
                setTimeout(spawnCow, 2000 - gameState.level * 100);
            }
        }

        function startGame() {
            gameState.active = true;
            document.getElementById('mainMenu').style.display = 'none';
            gameState.level = 1;
            gameState.score = 0;
            gameState.lives = 3;
            gameState.ammo = 5;
            updateHUD();
            spawnCow();
            gameLoop();
        }

        function updateHUD() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('ammo').textContent = gameState.ammo;
            document.getElementById('hearts').innerHTML = 
                Array(3).fill().map((_,i) => 
                    `<span class="heart ${i >= gameState.lives ? 'burned' : ''}">♥</span>`
                ).join('');
            document.getElementById('level').textContent = `LEVEL ${gameState.level}`;
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resize);
        resize();

        // Initialize Telegram WebApp
        if (typeof Telegram !== 'undefined') {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
        }
    </script>
</body>
</html>