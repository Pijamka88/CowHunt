<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–ø–∏–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --dark-brown: #5e3a1f;
            --medium-brown: #8b5a2b;
            --light-brown: #d2a679;
            --parchment: #f5e7d0;
            --red: #a52a2a;
            --green: #2e8b57;
            --blue: #4169e1;
            --yellow: #daa520;
        }
        
        body {
            font-family: 'Times New Roman', serif;
            max-width: 100%;
            margin: 0;
            padding: 0;
            background-color: var(--parchment);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="%23d2a679" fill-opacity="0.1" d="M0 0h100v100H0z"/><path fill="none" stroke="%235e3a1f" stroke-width="0.5" stroke-opacity="0.2" d="M20 0v100M40 0v100M60 0v100M80 0v100M0 20h100M0 40h100M0 60h100M0 80h100"/></svg>');
            color: var(--dark-brown);
            overflow-x: hidden;
        }
        
        #main-menu, #game-screen {
            background-color: var(--parchment);
            border: 8px double var(--dark-brown);
            border-radius: 5px;
            margin: 10px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        h1, h2, h3 {
            color: var(--dark-brown);
            text-align: center;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            margin-top: 0;
        }
        
        h1 {
            font-size: 2.5rem;
            border-bottom: 2px solid var(--dark-brown);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        button {
            background-color: var(--medium-brown);
            border: 2px solid var(--dark-brown);
            color: white;
            padding: 8px 12px;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            margin: 5px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        button:hover {
            background-color: var(--dark-brown);
            transform: translateY(-2px);
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .pet-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--parchment);
            border: 3px double var(--dark-brown);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .pets-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .pet-card {
            background-color: var(--parchment);
            border: 4px double var(--dark-brown);
            border-radius: 10px;
            padding: 10px;
            width: 120px;
            text-align: center;
            position: relative;
            transition: all 0.3s;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .pet-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        }
        
        .pet-card.active {
            border-color: var(--red);
            box-shadow: 0 0 0 3px var(--red);
        }
        
        .pet {
            font-size: 48px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .pet:hover {
            transform: scale(1.1);
        }
        
        .pet-level {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: var(--red);
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            border: 2px solid white;
        }
        
        .pet-stats {
            margin-top: 10px;
            font-size: 0.8rem;
        }
        
        .stat-bar {
            height: 8px;
            background-color: #ddd;
            border-radius: 4px;
            margin: 3px 0;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            border-radius: 4px;
        }
        
        .health { background-color: var(--red); }
        .hunger { background-color: var(--green); }
        .energy { background-color: var(--blue); }
        .happiness { background-color: var(--yellow); }
        
        .actions-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
            gap: 5px;
        }
        
        .action-btn {
            min-width: 80px;
        }
        
        .exp-container {
            margin: 15px 0;
        }
        
        .exp-bar {
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            overflow: hidden;
            border: 1px solid var(--dark-brown);
        }
        
        .exp-fill {
            height: 100%;
            background-color: var(--medium-brown);
            width: 0%;
            transition: width 0.5s;
        }
        
        .exp-text {
            text-align: center;
            font-size: 0.9rem;
            margin-top: 3px;
        }
        
        .menu-button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 10px;
            font-size: 1.2rem;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .bounce {
            animation: bounce 1s infinite;
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
        
        .evolution-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            color: white;
            font-size: 1.5rem;
            text-align: center;
        }
        
        .evolution-text {
            margin: 20px;
        }
    </style>
</head>
<body>
    <div id="main-menu">
        <h1>–¢–∞–ø–∏–∫–∏</h1>
        <button id="continue-btn" class="menu-button">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        <button id="new-game-btn" class="menu-button">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    </div>
    
    <div id="game-screen" style="display: none;">
        <div class="pet-counter" id="pet-counter">0</div>
        <h2>–í–∞—à–∏ —Ç–∞–ø–∏–∫–∏</h2>
        
        <div class="exp-container">
            <div class="exp-bar">
                <div class="exp-fill" id="exp-fill"></div>
            </div>
            <div class="exp-text" id="exp-text">–û–ø—ã—Ç: 0/100</div>
        </div>
        
        <div class="pets-container" id="pets-container">
            <!-- –ü–∏—Ç–æ–º—Ü—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
        
        <div class="actions-container">
            <button class="action-btn" id="feed-btn">üçé –ö–æ—Ä–º–∏—Ç—å</button>
            <button class="action-btn" id="play-btn">üé≤ –ò–≥—Ä–∞—Ç—å</button>
            <button class="action-btn" id="sleep-btn">üåô –°–ø–∞—Ç—å</button>
            <button class="action-btn" id="heal-btn">üíä –õ–µ—á–∏—Ç—å</button>
            <button class="action-btn" id="train-btn">‚öîÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
    </div>
    
    <div id="evolution-screen" class="evolution-animation" style="display: none;">
        <div class="pet" id="evolution-pet" style="font-size: 72px;"></div>
        <div class="evolution-text" id="evolution-text">–í–∞—à —Ç–∞–ø–∏–∫ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç!</div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            pets: [],
            currentPetIndex: 0,
            lastUpdate: Date.now(),
            version: 1
        };
        
        // –¶–≤–µ—Ç–∞ –¥–ª—è —Ç–∞–ø–∏–∫–æ–≤
        const bearColors = [
            'üêª', // –∫–æ—Ä–∏—á–Ω–µ–≤—ã–π
            'üêª‚Äç‚ùÑÔ∏è', // –±–µ–ª—ã–π
            'üß∏', // –∂–µ–ª—Ç—ã–π
            'üêæ', // —á–µ—Ä–Ω—ã–π
            'üçØ'  // –∑–æ–ª–æ—Ç–æ–π
        ];
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const elements = {
            mainMenu: document.getElementById('main-menu'),
            gameScreen: document.getElementById('game-screen'),
            evolutionScreen: document.getElementById('evolution-screen'),
            evolutionPet: document.getElementById('evolution-pet'),
            evolutionText: document.getElementById('evolution-text'),
            petsContainer: document.getElementById('pets-container'),
            petCounter: document.getElementById('pet-counter'),
            expFill: document.getElementById('exp-fill'),
            expText: document.getElementById('exp-text'),
            continueBtn: document.getElementById('continue-btn'),
            newGameBtn: document.getElementById('new-game-btn'),
            feedBtn: document.getElementById('feed-btn'),
            playBtn: document.getElementById('play-btn'),
            sleepBtn: document.getElementById('sleep-btn'),
            healBtn: document.getElementById('heal-btn'),
            trainBtn: document.getElementById('train-btn')
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadGame();
            setupEventListeners();
            updateMenu();
            
            if (gameState.pets.length > 0) {
                showGameScreen();
                updateGameUI();
            } else {
                showMainMenu();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            setInterval(gameLoop, 1000);
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            elements.continueBtn.addEventListener('click', showGameScreen);
            elements.newGameBtn.addEventListener('click', startNewGame);
            
            elements.feedBtn.addEventListener('click', () => performAction('feed'));
            elements.playBtn.addEventListener('click', () => performAction('play'));
            elements.sleepBtn.addEventListener('click', () => performAction('sleep'));
            elements.healBtn.addEventListener('click', () => performAction('heal'));
            elements.trainBtn.addEventListener('click', () => performAction('train'));
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            if (gameState.pets.length === 0) return;
            
            const now = Date.now();
            const deltaTime = (now - gameState.lastUpdate) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            gameState.lastUpdate = now;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
            gameState.pets.forEach(pet => {
                updatePet(pet, deltaTime);
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            saveGame();
            updateGameUI();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∏—Ç–æ–º—Ü–∞
        function updatePet(pet, deltaTime) {
            // –£–º–µ–Ω—å—à–∞–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
            pet.hunger = Math.max(0, pet.hunger - 0.5 * deltaTime);
            pet.energy = Math.max(0, pet.energy - 0.3 * deltaTime);
            pet.happiness = Math.max(0, pet.happiness - 0.2 * deltaTime);
            
            // –ï—Å–ª–∏ –≥–æ–ª–æ–¥ –∏–ª–∏ —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ –Ω—É–ª–µ, —É–º–µ–Ω—å—à–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
            if (pet.hunger <= 0 || pet.energy <= 0) {
                pet.health = Math.max(0, pet.health - 1 * deltaTime);
            }
            
            // –ï—Å–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ –Ω—É–ª–µ, —É–º–µ–Ω—å—à–∞–µ–º —Å—á–∞—Å—Ç—å–µ
            if (pet.health <= 0) {
                pet.happiness = Math.max(0, pet.happiness - 1 * deltaTime);
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É–º–µ—Ä –ª–∏ –ø–∏—Ç–æ–º–µ—Ü
            if (pet.health <= 0 && !pet.isDead) {
                pet.isDead = true;
                pet.deathTime = Date.now();
            }
            
            // –ï—Å–ª–∏ –ø–∏—Ç–æ–º–µ—Ü –º–µ—Ä—Ç–≤ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç, —É–¥–∞–ª—è–µ–º –µ–≥–æ
            if (pet.isDead && Date.now() - pet.deathTime > 300000) {
                const index = gameState.pets.indexOf(pet);
                if (index !== -1) {
                    gameState.pets.splice(index, 1);
                    if (gameState.currentPetIndex >= index) {
                        gameState.currentPetIndex = Math.max(0, gameState.currentPetIndex - 1);
                    }
                }
            }
        }
        
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º
        function performAction(action) {
            const pet = gameState.pets[gameState.currentPetIndex];
            if (!pet || pet.isDead) return;
            
            switch (action) {
                case 'feed':
                    pet.hunger = Math.min(100, pet.hunger + 30);
                    pet.energy = Math.max(0, pet.energy - 5);
                    pet.exp += 5;
                    break;
                case 'play':
                    pet.happiness = Math.min(100, pet.happiness + 20);
                    pet.energy = Math.max(0, pet.energy - 10);
                    pet.hunger = Math.max(0, pet.hunger - 5);
                    pet.exp += 10;
                    break;
                case 'sleep':
                    pet.energy = Math.min(100, pet.energy + 40);
                    pet.hunger = Math.max(0, pet.hunger - 10);
                    pet.exp += 5;
                    break;
                case 'heal':
                    pet.health = Math.min(100, pet.health + 30);
                    pet.energy = Math.max(0, pet.energy - 15);
                    pet.exp += 5;
                    break;
                case 'train':
                    pet.energy = Math.max(0, pet.energy - 20);
                    pet.hunger = Math.max(0, pet.hunger - 15);
                    pet.exp += 20;
                    break;
            }
            
            checkLevelUp(pet);
            updateGameUI();
            saveGame();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp(pet) {
            const expNeeded = getExpForLevel(pet.level + 1);
            
            if (pet.exp >= expNeeded) {
                pet.level++;
                pet.exp -= expNeeded;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏ —ç–≤–æ–ª—é—Ü–∏—è (–∫–∞–∂–¥—ã–µ 3 —É—Ä–æ–≤–Ω—è)
                if (pet.level % 3 === 0) {
                    evolvePet(pet);
                }
                
                // –ï—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –∫—Ä–∞—Ç–µ–Ω 3, –ø–∏—Ç–æ–º–µ—Ü –º–æ–∂–µ—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç—å—Å—è
                if (pet.level % 3 === 0 && gameState.pets.length < bearColors.length) {
                    reproducePet(pet);
                }
            }
        }
        
        // –≠–≤–æ–ª—é—Ü–∏—è –ø–∏—Ç–æ–º—Ü–∞
        function evolvePet(pet) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —ç–≤–æ–ª—é—Ü–∏–∏
            showEvolutionScreen(pet);
            
            // –ü–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å
            setTimeout(() => {
                hideEvolutionScreen();
                updateGameUI();
            }, 2000);
        }
        
        // –†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞
        function reproducePet(parentPet) {
            // –ù–∞—Ö–æ–¥–∏–º —Å–≤–æ–±–æ–¥–Ω—ã–π —Ü–≤–µ—Ç, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â–µ –Ω–µ—Ç –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            const usedColors = gameState.pets.map(p => p.color);
            const availableColors = bearColors.filter(color => !usedColors.includes(color));
            
            if (availableColors.length > 0) {
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                const newPet = {
                    color: availableColors[0],
                    level: 1,
                    exp: 0,
                    health: 100,
                    hunger: 50,
                    energy: 80,
                    happiness: 70,
                    isDead: false,
                    birthTime: Date.now()
                };
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
                gameState.pets.push(newPet);
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—ã—Ç–∞ –¥–ª—è —É—Ä–æ–≤–Ω—è
        function getExpForLevel(level) {
            return 100 * Math.pow(level, 1.5);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–≥—Ä—ã
        function updateGameUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–∏—Ç–æ–º—Ü–µ–≤
            elements.petCounter.textContent = gameState.pets.length;
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏
            elements.petsContainer.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
            gameState.pets.forEach((pet, index) => {
                const petElement = document.createElement('div');
                petElement.className = `pet-card ${index === gameState.currentPetIndex ? 'active' : ''}`;
                if (pet.isDead) {
                    petElement.style.opacity = '0.6';
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                const petEmoji = document.createElement('div');
                petEmoji.className = `pet ${pet.isDead ? '' : 'pulse'}`;
                petEmoji.textContent = pet.color;
                petEmoji.addEventListener('click', () => {
                    gameState.currentPetIndex = index;
                    updateGameUI();
                });
                
                petElement.innerHTML = `
                    <div class="pet-level">${pet.level}</div>
                    <div class="pet-stats">
                        <div class="stat-bar"><div class="stat-fill health" style="width: ${pet.health}%"></div></div>
                        <div class="stat-bar"><div class="stat-fill hunger" style="width: ${pet.hunger}%"></div></div>
                        <div class="stat-bar"><div class="stat-fill energy" style="width: ${pet.energy}%"></div></div>
                        <div class="stat-bar"><div class="stat-fill happiness" style="width: ${pet.happiness}%"></div></div>
                    </div>
                `;
                
                petElement.prepend(petEmoji);
                elements.petsContainer.appendChild(petElement);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–æ—Å–∫—É –æ–ø—ã—Ç–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
            if (gameState.pets.length > 0) {
                const pet = gameState.pets[gameState.currentPetIndex];
                const expPercent = (pet.exp / getExpForLevel(pet.level + 1)) * 100;
                elements.expFill.style.width = `${expPercent}%`;
                elements.expText.textContent = `–û–ø—ã—Ç: ${Math.floor(pet.exp)}/${Math.floor(getExpForLevel(pet.level + 1))}`;
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏, –µ—Å–ª–∏ –ø–∏—Ç–æ–º–µ—Ü –º–µ—Ä—Ç–≤
                if (pet.isDead) {
                    elements.feedBtn.disabled = true;
                    elements.playBtn.disabled = true;
                    elements.sleepBtn.disabled = true;
                    elements.healBtn.disabled = true;
                    elements.trainBtn.disabled = true;
                } else {
                    elements.feedBtn.disabled = false;
                    elements.playBtn.disabled = false;
                    elements.sleepBtn.disabled = false;
                    elements.healBtn.disabled = false;
                    elements.trainBtn.disabled = false;
                }
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é
        function updateMenu() {
            elements.continueBtn.disabled = gameState.pets.length === 0;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω —ç–≤–æ–ª—é—Ü–∏–∏
        function showEvolutionScreen(pet) {
            elements.evolutionPet.textContent = pet.color;
            elements.evolutionText.textContent = `–¢–∞–ø–∏–∫ –¥–æ—Å—Ç–∏–≥ —É—Ä–æ–≤–Ω—è ${pet.level} –∏ —Å—Ç–∞–ª —Å–∏–ª—å–Ω–µ–µ!`;
            elements.evolutionScreen.style.display = 'flex';
        }
        
        // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω —ç–≤–æ–ª—é—Ü–∏–∏
        function hideEvolutionScreen() {
            elements.evolutionScreen.style.display = 'none';
        }
        
        // –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É
        function startNewGame() {
            // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
            const newPet = {
                color: bearColors[0],
                level: 1,
                exp: 0,
                health: 100,
                hunger: 50,
                energy: 80,
                happiness: 70,
                isDead: false,
                birthTime: Date.now()
            };
            
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ
            gameState.pets = [newPet];
            gameState.currentPetIndex = 0;
            gameState.lastUpdate = Date.now();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
            saveGame();
            showGameScreen();
            updateGameUI();
            updateMenu();
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É
        function saveGame() {
            localStorage.setItem('tapikiGame', JSON.stringify(gameState));
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É
        function loadGame() {
            const savedGame = localStorage.getItem('tapikiGame');
            if (savedGame) {
                const parsed = JSON.parse(savedGame);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                if (parsed.version === gameState.version) {
                    gameState = parsed;
                }
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
        function showMainMenu() {
            elements.mainMenu.style.display = 'block';
            elements.gameScreen.style.display = 'none';
            updateMenu();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∏–≥—Ä—ã
        function showGameScreen() {
            elements.mainMenu.style.display = 'none';
            elements.gameScreen.style.display = 'block';
            updateGameUI();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>