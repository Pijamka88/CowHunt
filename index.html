<!DOCTYPE html>
<html>
<head>
    <title>CosmoCows</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
        
        body {
            margin: 0;
            overflow: hidden;
            touch-action: none;
            background: #000;
            font-family: 'Orbitron', sans-serif;
        }
        #gameCanvas {
            background: #000;
            display: block;
        }
        .menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 2rem;
            color: #0ff;
            text-align: center;
            border-radius: 15px;
            border: 3px solid #0ff;
            box-shadow: 0 0 20px #0ff;
            z-index: 1000;
            max-width: 80%;
        }
        .menu h1 {
            margin: 0 0 1.5rem;
            font-size: 2.5rem;
            text-shadow: 0 0 10px #0ff;
        }
        .menu button {
            padding: 1rem 2rem;
            font-size: 1.2rem;
            margin-top: 1rem;
            cursor: pointer;
            background: linear-gradient(45deg, #00ffff, #0099ff);
            border: none;
            color: #000;
            border-radius: 8px;
            font-family: 'Orbitron';
            transition: all 0.3s;
            letter-spacing: 2px;
        }
        .menu button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #0ff;
        }
        #hud {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #0ff;
            display: flex;
            gap: 30px;
            font-size: 1.5rem;
            text-shadow: 0 0 10px #0ff;
        }
        .hearts {
            display: flex;
            gap: 10px;
        }
        .heart {
            color: #ff0000;
            text-shadow: 0 0 10px #ff0000;
        }
        #score {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            color: #0ff;
            text-shadow: 0 0 10px #0ff;
        }
    </style>
</head>
<body>
    <div id="mainMenu" class="menu">
        <h1>ðŸ›¸ COSMOCOWS ðŸ›¸</h1>
        <p>Protect the galaxy from space cows!</p>
        <button onclick="startGame()">LAUNCH</button>
    </div>

    <div id="gameOverMenu" class="menu" style="display: none;">
        <h1>MISSION END</h1>
        <p>SCORE: <span id="finalScore">0</span></p>
        <button onclick="startGame()">RETRY</button>
    </div>

    <div id="hud">
        <div class="hearts" id="lives">
            <span class="heart">â™¥</span>
            <span class="heart">â™¥</span>
            <span class="heart">â™¥</span>
        </div>
        <div id="timer">01:00</div>
    </div>
    <div id="score">00000</div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameActive = false;
        let cows = [];
        let shots = [];
        let explosions = [];
        let score = 0;
        let lives = 3;
        let timeLeft = 60;
        let ammo = 5;
        let isReloading = false;
        let eyePhase = 0;

        const config = {
            cowSpeed: 2.5,
            spawnInterval: 1500,
            maxCows: 5,
            cowLength: 60,
            cowHeight: 30
        };

        class Cow {
            constructor() {
                this.direction = Math.random() > 0.5 ? 1 : -1;
                this.x = this.direction === 1 ? -100 : canvas.width + 100;
                this.y = Math.random() * (canvas.height - 100) + 50;
                this.speed = Math.random() * 2 + 1.5;
                this.eyeOffset = 0;
                this.wingPhase = Math.random() * Math.PI * 2;
                this.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }

            update() {
                this.x += this.direction * this.speed;
                this.wingPhase += 0.1;
                this.eyeOffset = Math.sin(eyePhase) * 3;
                
                if (this.x < -200 || this.x > canvas.width + 200) {
                    this.reset();
                }
            }

            reset() {
                this.direction = Math.random() > 0.5 ? 1 : -1;
                this.x = this.direction === 1 ? -100 : canvas.width + 100;
                this.y = Math.random() * (canvas.height - 100) + 50;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                
                // Body
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 3;
                ctx.strokeRect(-config.cowLength/2, -config.cowHeight/2, config.cowLength, config.cowHeight);
                
                // Head
                ctx.beginPath();
                ctx.arc(config.cowLength/2, 0, 15, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                ctx.fill();
                ctx.stroke();
                
                // Horns
                ctx.beginPath();
                ctx.moveTo(config.cowLength/2 + 10, -10);
                ctx.lineTo(config.cowLength/2 + 20, -20);
                ctx.moveTo(config.cowLength/2 + 10, 10);
                ctx.lineTo(config.cowLength/2 + 20, 20);
                ctx.stroke();
                
                // Eyes
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(config.cowLength/2 + 5, this.eyeOffset, 3, 0, Math.PI * 2);
                ctx.arc(config.cowLength/2 + 5, -this.eyeOffset, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Wings
                ctx.strokeStyle = this.color;
                const wingY = Math.sin(this.wingPhase) * 10;
                ctx.beginPath();
                ctx.moveTo(-config.cowLength/2, 0);
                ctx.lineTo(-config.cowLength/2 - 30, wingY);
                ctx.lineTo(-config.cowLength/2 - 30, -wingY);
                ctx.closePath();
                ctx.stroke();
                
                // Legs
                for (let i = 0; i < 4; i++) {
                    ctx.beginPath();
                    ctx.moveTo(-config.cowLength/2 + 10 + i*15, config.cowHeight/2);
                    ctx.lineTo(-config.cowLength/2 + 10 + i*15, config.cowHeight/2 + 20);
                    ctx.stroke();
                }
                
                ctx.restore();
            }
        }

        class Explosion {
            constructor(x, y) {
                this.particles = [];
                for (let i = 0; i < 20; i++) {
                    this.particles.push({
                        x: x + Math.random() * 20 - 10,
                        y: y + Math.random() * 20 - 10,
                        vx: (Math.random() - 0.5) * 5,
                        vy: (Math.random() - 0.5) * 5,
                        size: Math.random() * 5 + 2,
                        alpha: 1
                    });
                }
            }

            update() {
                this.particles = this.particles.filter(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.alpha -= 0.03;
                    return p.alpha > 0;
                });
                return this.particles.length > 0;
            }

            draw() {
                this.particles.forEach(p => {
                    ctx.fillStyle = `rgba(0, 255, 100, ${p.alpha})`;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
        }

        function startGame() {
            gameActive = true;
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('gameOverMenu').style.display = 'none';
            
            cows = [];
            shots = [];
            explosions = [];
            score = 0;
            lives = 3;
            timeLeft = 60;
            ammo = 5;
            
            updateHUD();
            resizeCanvas();
            
            const gameTimer = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    clearInterval(gameTimer);
                    endGame();
                }
                updateHUD();
            }, 1000);
            
            spawnCow();
            gameLoop();
        }

        function endGame() {
            gameActive = false;
            document.getElementById('gameOverMenu').style.display = 'block';
            document.getElementById('finalScore').textContent = score.toString().padStart(5, '0');
        }

        function updateHUD() {
            document.getElementById('score').textContent = score.toString().padStart(5, '0');
            document.getElementById('timer').textContent = 
                `${Math.floor(timeLeft/60).toString().padStart(2, '0')}:${(timeLeft%60).toString().padStart(2, '0')}`;
            
            const hearts = document.querySelectorAll('.heart');
            hearts.forEach((heart, i) => heart.style.visibility = i < lives ? 'visible' : 'hidden');
        }

        function spawnCow() {
            if (!gameActive || cows.length >= config.maxCows) return;
            
            cows.push(new Cow());
            setTimeout(spawnCow, config.spawnInterval);
        }

        function checkHit(x, y) {
            cows.forEach((cow, i) => {
                const cowRect = {
                    left: cow.x - config.cowLength/2,
                    right: cow.x + config.cowLength/2,
                    top: cow.y - config.cowHeight/2,
                    bottom: cow.y + config.cowHeight/2
                };
                
                if (x >= cowRect.left && x <= cowRect.right && 
                    y >= cowRect.top && y <= cowRect.bottom) {
                    explosions.push(new Explosion(cow.x, cow.y));
                    cows.splice(i, 1);
                    score += 1000;
                    updateHUD();
                }
            });
        }

        function drawNebula() {
            const gradient = ctx.createRadialGradient(
                canvas.width/2, canvas.height/2, 0,
                canvas.width/2, canvas.height/2, Math.max(canvas.width, canvas.height)
            );
            gradient.addColorStop(0, 'rgba(100, 50, 255, 0.3)');
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function gameLoop() {
            if (!gameActive) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawNebula();
            
            eyePhase += 0.1;
            
            cows.forEach(cow => {
                cow.update();
                cow.draw();
            });
            
            explosions.forEach((exp, i) => {
                if (!exp.update()) explosions.splice(i, 1);
                exp.draw();
            });
            
            requestAnimationFrame(gameLoop);
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        canvas.addEventListener('click', (e) => {
            if (!gameActive || isReloading) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            if (ammo > 0) {
                ammo--;
                checkHit(x, y);
            } else {
                lives--;
                if (lives <= 0) endGame();
                isReloading = true;
                setTimeout(() => {
                    ammo = 5;
                    isReloading = false;
                }, 2000);
            }
            updateHUD();
        });

        window.addEventListener('resize', resizeCanvas);
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
    </script>
</body>
</html>