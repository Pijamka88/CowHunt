<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Cow Hunt</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            background-color: #000;
            touch-action: manipulation;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        
        #gameCanvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        
        #backgroundCanvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
        }
        
        #menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 30, 0.8);
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
        
        #menu h1 {
            font-size: 3rem;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px #4fc3f7, 0 0 20px #4fc3f7;
            color: #fff;
        }
        
        .menu-button {
            background: linear-gradient(135deg, #4fc3f7, #01579b);
            border: none;
            color: white;
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.5);
        }
        
        .menu-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.8);
        }
        
        #ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            z-index: 2;
            color: white;
            font-size: 1.2rem;
            text-shadow: 1px 1px 2px black;
        }
        
        #bottomUI {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            z-index: 2;
            color: white;
            font-size: 1.2rem;
            text-shadow: 1px 1px 2px black;
        }
        
        #ammo {
            display: flex;
            align-items: center;
        }
        
        .bullet {
            width: 20px;
            height: 30px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 30"><path fill="%23FFD700" d="M10 0 L20 10 L15 15 L20 20 L10 30 L0 20 L5 15 L0 10 Z"/></svg>') no-repeat;
            background-size: contain;
            margin-right: 5px;
        }
        
        .heart {
            width: 24px;
            height: 24px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%23FF5252" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') no-repeat;
            background-size: contain;
            margin-left: 5px;
        }
        
        #lives {
            display: flex;
            align-items: center;
        }
        
        #gameOver {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 30, 0.9);
            z-index: 20;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
        
        #gameOver h2 {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px #ff5252, 0 0 20px #ff5252;
        }
        
        #finalScore {
            font-size: 2rem;
            margin-bottom: 2rem;
        }
        
        #crosshair {
            position: absolute;
            width: 40px;
            height: 40px;
            pointer-events: none;
            z-index: 5;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><circle cx="20" cy="20" r="15" fill="none" stroke="%234fc3f7" stroke-width="2"/><line x1="20" y1="5" x2="20" y2="15" stroke="%234fc3f7" stroke-width="2"/><line x1="20" y1="25" x2="20" y2="35" stroke="%234fc3f7" stroke-width="2"/><line x1="5" y1="20" x2="15" y2="20" stroke="%234fc3f7" stroke-width="2"/><line x1="25" y1="20" x2="35" y2="20" stroke="%234fc3f7" stroke-width="2"/></svg>') no-repeat;
            background-size: contain;
            transform: translate(-50%, -50%);
            display: none;
        }
        
        .hitEffect {
            position: absolute;
            width: 80px;
            height: 80px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80"><circle cx="40" cy="40" r="30" fill="none" stroke="%23FFD700" stroke-width="4" stroke-dasharray="5,5"/><circle cx="40" cy="40" r="20" fill="none" stroke="%234fc3f7" stroke-width="4" stroke-dasharray="3,3"/><path fill="%23FFD700" d="M40 10 L50 30 L70 40 L50 50 L40 70 L30 50 L10 40 L30 30 Z"/></svg>') no-repeat;
            background-size: contain;
            z-index: 3;
            pointer-events: none;
            animation: hitAnimation 0.5s forwards;
        }
        
        @keyframes hitAnimation {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="backgroundCanvas"></canvas>
        <canvas id="gameCanvas"></canvas>
        
        <div id="ui">
            <div id="score">Score: 0</div>
            <div id="time">Time: 60</div>
            <div id="lives">Lives: <span id="hearts"></span></div>
        </div>
        
        <div id="bottomUI">
            <div id="ammo"></div>
            <div id="hits">Hits: 0 | Misses: 0</div>
        </div>
        
        <div id="crosshair"></div>
        
        <div id="menu">
            <h1>Cosmic Cow Hunt</h1>
            <button class="menu-button" id="startButton">Start Game</button>
            <button class="menu-button" id="howToPlayButton">How to Play</button>
        </div>
        
        <div id="gameOver">
            <h2>Game Over</h2>
            <div id="finalScore">Your Score: 0</div>
            <button class="menu-button" id="restartButton">Play Again</button>
            <button class="menu-button" id="menuButton">Main Menu</button>
        </div>
    </div>

    <script>
        // Game constants
        const GAME_DURATION = 60; // seconds
        const MAX_LIVES = 3;
        const AMMO_CAPACITY = 5;
        const RELOAD_TIME = 2000; // ms
        const COW_SPAWN_RATE = 1000; // ms
        const PLANET_COUNT = 5;
        
        // Game variables
        let score = 0;
        let timeLeft = GAME_DURATION;
        let lives = MAX_LIVES;
        let hits = 0;
        let misses = 0;
        let ammo = AMMO_CAPACITY;
        let isReloading = false;
        let gameRunning = false;
        let gameTimeInterval;
        let cowSpawnInterval;
        let animationFrameId;
        
        // Canvas setup
        const backgroundCanvas = document.getElementById('backgroundCanvas');
        const backgroundCtx = backgroundCanvas.getContext('2d');
        const gameCanvas = document.getElementById('gameCanvas');
        const gameCtx = gameCanvas.getContext('2d');
        
        // UI elements
        const scoreElement = document.getElementById('score');
        const timeElement = document.getElementById('time');
        const hitsElement = document.getElementById('hits');
        const heartsElement = document.getElementById('hearts');
        const ammoElement = document.getElementById('ammo');
        const menuElement = document.getElementById('menu');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const startButton = document.getElementById('startButton');
        const howToPlayButton = document.getElementById('howToPlayButton');
        const restartButton = document.getElementById('restartButton');
        const menuButton = document.getElementById('menuButton');
        const crosshair = document.getElementById('crosshair');
        
        // Resize canvases to window size
        function resizeCanvases() {
            backgroundCanvas.width = window.innerWidth;
            backgroundCanvas.height = window.innerHeight;
            gameCanvas.width = window.innerWidth;
            gameCanvas.height = window.innerHeight;
        }
        
        // Initialize game
        function initGame() {
            resizeCanvases();
            updateUI();
            createAmmoDisplay();
            createHeartsDisplay();
            
            // Event listeners
            startButton.addEventListener('click', startGame);
            howToPlayButton.addEventListener('click', showHowToPlay);
            restartButton.addEventListener('click', restartGame);
            menuButton.addEventListener('click', showMenu);
            gameCanvas.addEventListener('mousedown', handleShoot);
            gameCanvas.addEventListener('touchstart', handleShoot);
            gameCanvas.addEventListener('mousemove', updateCrosshair);
            gameCanvas.addEventListener('touchmove', updateCrosshair);
            window.addEventListener('resize', resizeCanvases);
        }
        
        // Create ammo display
        function createAmmoDisplay() {
            ammoElement.innerHTML = '';
            for (let i = 0; i < AMMO_CAPACITY; i++) {
                const bullet = document.createElement('div');
                bullet.className = 'bullet';
                if (i >= ammo) {
                    bullet.style.opacity = '0.3';
                }
                ammoElement.appendChild(bullet);
            }
        }
        
        // Create hearts display
        function createHeartsDisplay() {
            heartsElement.innerHTML = '';
            for (let i = 0; i < MAX_LIVES; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                if (i >= lives) {
                    heart.style.opacity = '0.3';
                }
                heartsElement.appendChild(heart);
            }
        }
        
        // Update UI
        function updateUI() {
            scoreElement.textContent = `Score: ${score}`;
            timeElement.textContent = `Time: ${timeLeft}`;
            hitsElement.textContent = `Hits: ${hits} | Misses: ${misses}`;
            
            // Update ammo display
            const bullets = ammoElement.querySelectorAll('.bullet');
            bullets.forEach((bullet, index) => {
                bullet.style.opacity = index < ammo ? '1' : '0.3';
            });
            
            // Update hearts display
            const hearts = heartsElement.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                heart.style.opacity = index < lives ? '1' : '0.3';
            });
        }
        
        // Start game
        function startGame() {
            // Reset game state
            score = 0;
            timeLeft = GAME_DURATION;
            lives = MAX_LIVES;
            hits = 0;
            misses = 0;
            ammo = AMMO_CAPACITY;
            isReloading = false;
            gameRunning = true;
            
            // Clear any existing cows
            cows = [];
            hitEffects = [];
            
            // Update UI
            updateUI();
            
            // Hide menu and show game
            menuElement.style.display = 'none';
            gameOverElement.style.display = 'none';
            crosshair.style.display = 'block';
            
            // Start game timers
            gameTimeInterval = setInterval(updateGameTime, 1000);
            cowSpawnInterval = setInterval(spawnCow, COW_SPAWN_RATE);
            
            // Draw background
            drawBackground();
            
            // Start game loop
            gameLoop();
        }
        
        // Game loop
        function gameLoop() {
            if (!gameRunning) return;
            
            // Clear game canvas
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            
            // Draw planets
            drawPlanets();
            
            // Update and draw cows
            updateCows();
            
            // Draw hit effects
            drawHitEffects();
            
            // Continue loop
            animationFrameId = requestAnimationFrame(gameLoop);
        }
        
        // Update game time
        function updateGameTime() {
            timeLeft--;
            updateUI();
            
            if (timeLeft <= 0) {
                endGame();
            }
        }
        
        // Spawn a new cow
        function spawnCow() {
            if (!gameRunning) return;
            
            const cow = {
                x: Math.random() * (gameCanvas.width - 100),
                y: gameCanvas.height,
                width: 80,
                height: 80,
                speed: 1 + Math.random() * 3,
                frame: 0,
                frameCount: 4,
                frameSpeed: 5,
                frameIndex: 0,
                alive: true,
                deathFrame: 0,
                deathFrames: 5,
                angle: Math.random() * 20 - 10 // Random angle for flight path
            };
            
            cows.push(cow);
        }
        
        // Update cows
        function updateCows() {
            for (let i = cows.length - 1; i >= 0; i--) {
                const cow = cows[i];
                
                if (cow.alive) {
                    // Update position
                    cow.x += Math.sin(cow.angle * Math.PI / 180) * 2;
                    cow.y -= cow.speed;
                    
                    // Update animation frame
                    cow.frameIndex++;
                    if (cow.frameIndex >= cow.frameSpeed) {
                        cow.frameIndex = 0;
                        cow.frame = (cow.frame + 1) % cow.frameCount;
                    }
                    
                    // Draw cow
                    drawCow(cow);
                    
                    // Check if cow flew off screen
                    if (cow.y < -cow.height || cow.x < -cow.width || cow.x > gameCanvas.width) {
                        cows.splice(i, 1);
                        misses++;
                        updateUI();
                    }
                } else {
                    // Update death animation
                    cow.deathFrame += 0.2;
                    
                    // Draw dying cow
                    drawDyingCow(cow);
                    
                    // Remove when death animation complete
                    if (cow.deathFrame >= cow.deathFrames) {
                        cows.splice(i, 1);
                    }
                }
            }
        }
        
        // Draw cow
        function drawCow(cow) {
            gameCtx.save();
            gameCtx.translate(cow.x + cow.width / 2, cow.y + cow.height / 2);
            
            // Body
            gameCtx.fillStyle = '#8D6E63';
            gameCtx.beginPath();
            gameCtx.ellipse(0, 0, cow.width / 2.5, cow.height / 3, 0, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Head
            gameCtx.fillStyle = '#A1887F';
            gameCtx.beginPath();
            gameCtx.ellipse(0, -cow.height / 4, cow.width / 4, cow.height / 5, 0, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Eyes (from spacesuit)
            gameCtx.fillStyle = '#4FC3F7';
            gameCtx.beginPath();
            gameCtx.arc(-cow.width / 10, -cow.height / 4, cow.width / 15, 0, Math.PI * 2);
            gameCtx.fill();
            
            gameCtx.beginPath();
            gameCtx.arc(cow.width / 10, -cow.height / 4, cow.width / 15, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Nose (from spacesuit)
            gameCtx.fillStyle = '#FF5252';
            gameCtx.beginPath();
            gameCtx.arc(0, -cow.height / 5, cow.width / 20, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Wings (animation frames)
            gameCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            const wingY = -cow.height / 8;
            
            if (cow.frame === 0) {
                // Wings up
                gameCtx.beginPath();
                gameCtx.ellipse(-cow.width / 3, wingY, cow.width / 4, cow.height / 8, Math.PI / 4, 0, Math.PI * 2);
                gameCtx.fill();
                
                gameCtx.beginPath();
                gameCtx.ellipse(cow.width / 3, wingY, cow.width / 4, cow.height / 8, -Math.PI / 4, 0, Math.PI * 2);
                gameCtx.fill();
            } else if (cow.frame === 1) {
                // Wings middle
                gameCtx.beginPath();
                gameCtx.ellipse(-cow.width / 3, wingY, cow.width / 4, cow.height / 6, 0, 0, Math.PI * 2);
                gameCtx.fill();
                
                gameCtx.beginPath();
                gameCtx.ellipse(cow.width / 3, wingY, cow.width / 4, cow.height / 6, 0, 0, Math.PI * 2);
                gameCtx.fill();
            } else if (cow.frame === 2) {
                // Wings down
                gameCtx.beginPath();
                gameCtx.ellipse(-cow.width / 3, wingY, cow.width / 4, cow.height / 8, -Math.PI / 4, 0, Math.PI * 2);
                gameCtx.fill();
                
                gameCtx.beginPath();
                gameCtx.ellipse(cow.width / 3, wingY, cow.width / 4, cow.height / 8, Math.PI / 4, 0, Math.PI * 2);
                gameCtx.fill();
            } else {
                // Wings middle again
                gameCtx.beginPath();
                gameCtx.ellipse(-cow.width / 3, wingY, cow.width / 4, cow.height / 6, 0, 0, Math.PI * 2);
                gameCtx.fill();
                
                gameCtx.beginPath();
                gameCtx.ellipse(cow.width / 3, wingY, cow.width / 4, cow.height / 6, 0, 0, Math.PI * 2);
                gameCtx.fill();
            }
            
            // Spacesuit details
            gameCtx.strokeStyle = '#4FC3F7';
            gameCtx.lineWidth = 2;
            gameCtx.beginPath();
            gameCtx.arc(0, 0, cow.width / 2.5, 0, Math.PI * 2);
            gameCtx.stroke();
            
            gameCtx.restore();
        }
        
        // Draw dying cow
        function drawDyingCow(cow) {
            const frame = Math.floor(cow.deathFrame);
            const progress = cow.deathFrame - frame;
            
            gameCtx.save();
            gameCtx.translate(cow.x + cow.width / 2, cow.y + cow.height / 2);
            
            // Apply death animation (falling and spinning)
            gameCtx.rotate(frame * Math.PI / 4 + progress * Math.PI / 4);
            gameCtx.translate(0, frame * 5 + progress * 5);
            
            // Draw cow with damage
            gameCtx.fillStyle = '#8D6E63';
            gameCtx.beginPath();
            gameCtx.ellipse(0, 0, cow.width / 2.5, cow.height / 3, 0, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Damaged head
            gameCtx.fillStyle = '#A1887F';
            gameCtx.beginPath();
            gameCtx.ellipse(0, -cow.height / 4, cow.width / 4, cow.height / 5 * (1 - frame * 0.1), 0, 0, Math.PI * 2);
            gameCtx.fill();
            
            // Cracked visor
            gameCtx.strokeStyle = 'white';
            gameCtx.lineWidth = 1;
            gameCtx.beginPath();
            gameCtx.arc(-cow.width / 10, -cow.height / 4, cow.width / 15, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(-cow.width / 10 - cow.width / 20, -cow.height / 4 - cow.width / 20);
            gameCtx.lineTo(-cow.width / 10 + cow.width / 20, -cow.height / 4 + cow.width / 20);
            gameCtx.stroke();
            
            gameCtx.beginPath();
            gameCtx.arc(cow.width / 10, -cow.height / 4, cow.width / 15, 0, Math.PI * 2);
            gameCtx.stroke();
            gameCtx.beginPath();
            gameCtx.moveTo(cow.width / 10 - cow.width / 20, -cow.height / 4 - cow.width / 20);
            gameCtx.lineTo(cow.width / 10 + cow.width / 20, -cow.height / 4 + cow.width / 20);
            gameCtx.stroke();
            
            // Smoke from damage
            if (frame > 1) {
                gameCtx.fillStyle = `rgba(100, 100, 100, ${0.5 - frame * 0.1})`;
                for (let i = 0; i < 3; i++) {
                    const size = cow.width / 10 + frame * 2;
                    gameCtx.beginPath();
                    gameCtx.ellipse(
                        Math.random() * cow.width / 2 - cow.width / 4,
                        Math.random() * cow.height / 2 - cow.height / 4,
                        size,
                        size / 2,
                        0,
                        0,
                        Math.PI * 2
                    );
                    gameCtx.fill();
                }
            }
            
            gameCtx.restore();
        }
        
        // Handle shooting
        function handleShoot(e) {
            if (!gameRunning || isReloading) return;
            
            e.preventDefault();
            
            if (ammo <= 0) {
                reload();
                return;
            }
            
            ammo--;
            updateUI();
            
            // Get mouse/touch position
            let x, y;
            if (e.type === 'mousedown') {
                x = e.clientX;
                y = e.clientY;
            } else {
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            }
            
            // Check for hits
            let hit = false;
            for (let i = 0; i < cows.length; i++) {
                const cow = cows[i];
                if (cow.alive && isPointInCow(x, y, cow)) {
                    // Hit!
                    hit = true;
                    cow.alive = false;
                    score += 100;
                    hits++;
                    
                    // Add hit effect
                    addHitEffect(x, y);
                    break;
                }
            }
            
            if (!hit) {
                misses++;
            }
            
            updateUI();
            
            // Reload if out of ammo
            if (ammo <= 0) {
                reload();
            }
        }
        
        // Check if point is inside cow
        function isPointInCow(x, y, cow) {
            return x > cow.x && x < cow.x + cow.width &&
                   y > cow.y && y < cow.y + cow.height;
        }
        
        // Reload
        function reload() {
            if (isReloading) return;
            
            isReloading = true;
            setTimeout(() => {
                ammo = AMMO_CAPACITY;
                isReloading = false;
                updateUI();
            }, RELOAD_TIME);
        }
        
        // Add hit effect
        function addHitEffect(x, y) {
            hitEffects.push({
                x: x,
                y: y,
                frame: 0
            });
        }
        
        // Draw hit effects
        function drawHitEffects() {
            for (let i = hitEffects.length - 1; i >= 0; i--) {
                const effect = hitEffects[i];
                effect.frame++;
                
                if (effect.frame > 30) {
                    hitEffects.splice(i, 1);
                    continue;
                }
                
                const size = effect.frame * 3;
                const opacity = 1 - effect.frame / 30;
                
                gameCtx.save();
                gameCtx.translate(effect.x, effect.y);
                
                // Golden burst
                gameCtx.fillStyle = `rgba(255, 215, 0, ${opacity})`;
                for (let j = 0; j < 8; j++) {
                    const angle = (j / 8) * Math.PI * 2;
                    const length = size * (0.7 + Math.random() * 0.3);
                    gameCtx.beginPath();
                    gameCtx.moveTo(0, 0);
                    gameCtx.lineTo(Math.cos(angle) * length, Math.sin(angle) * length);
                    gameCtx.lineWidth = 3;
                    gameCtx.strokeStyle = `rgba(255, 215, 0, ${opacity})`;
                    gameCtx.stroke();
                }
                
                // Blue circle
                gameCtx.beginPath();
                gameCtx.arc(0, 0, size * 0.6, 0, Math.PI * 2);
                gameCtx.strokeStyle = `rgba(79, 195, 247, ${opacity})`;
                gameCtx.lineWidth = 2;
                gameCtx.stroke();
                
                gameCtx.restore();
            }
        }
        
        // Update crosshair position
        function updateCrosshair(e) {
            if (!gameRunning) return;
            
            let x, y;
            if (e.type === 'mousemove') {
                x = e.clientX;
                y = e.clientY;
            } else {
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            }
            
            crosshair.style.left = `${x}px`;
            crosshair.style.top = `${y}px`;
        }
        
        // Draw background
        function drawBackground() {
            backgroundCtx.fillStyle = '#000033';
            backgroundCtx.fillRect(0, 0, backgroundCanvas.width, backgroundCanvas.height);
            
            // Add fog effect
            const fogGradient = backgroundCtx.createRadialGradient(
                backgroundCanvas.width / 2,
                backgroundCanvas.height / 2,
                0,
                backgroundCanvas.width / 2,
                backgroundCanvas.height / 2,
                Math.max(backgroundCanvas.width, backgroundCanvas.height) / 2
            );
            fogGradient.addColorStop(0, 'rgba(0, 20, 60, 0.1)');
            fogGradient.addColorStop(1, 'rgba(0, 40, 100, 0.5)');
            backgroundCtx.fillStyle = fogGradient;
            backgroundCtx.fillRect(0, 0, backgroundCanvas.width, backgroundCanvas.height);
            
            // Draw stars
            drawStars();
            
            // Initialize planets
            initPlanets();
        }
        
        // Draw stars
        function drawStars() {
            const starCount = 100;
            
            for (let i = 0; i < starCount; i++) {
                const x = Math.random() * backgroundCanvas.width;
                const y = Math.random() * backgroundCanvas.height;
                const size = 1 + Math.random() * 2;
                const brightness = 0.5 + Math.random() * 0.5;
                const color = Math.random() > 0.5 ? 
                    `rgba(100, 200, 255, ${brightness})` : 
                    `rgba(255, 215, 0, ${brightness})`;
                
                backgroundCtx.fillStyle = color;
                
                // Draw 4-pointed star
                backgroundCtx.save();
                backgroundCtx.translate(x, y);
                backgroundCtx.rotate(Math.PI / 4);
                backgroundCtx.fillRect(-size / 2, -size / 2, size, size);
                backgroundCtx.rotate(Math.PI / 2);
                backgroundCtx.fillRect(-size / 2, -size / 2, size, size);
                backgroundCtx.restore();
            }
        }
        
        // Initialize planets
        function initPlanets() {
            planets = [];
            
            for (let i = 0; i < PLANET_COUNT; i++) {
                let validPosition = false;
                let x, y, radius;
                
                // Keep trying until we find a position that doesn't overlap
                while (!validPosition) {
                    radius = 50 + Math.random() * 100;
                    x = radius + Math.random() * (backgroundCanvas.width - radius * 2);
                    y = radius + Math.random() * (backgroundCanvas.height - radius * 2);
                    
                    validPosition = true;
                    
                    // Check against other planets
                    for (const planet of planets) {
                        const dx = planet.x - x;
                        const dy = planet.y - y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < planet.radius + radius + 50) {
                            validPosition = false;
                            break;
                        }
                    }
                }
                
                // Choose a color gradient
                const color1 = Math.random() > 0.5 ? 
                    `hsl(${200 + Math.random() * 40}, 70%, 50%)` : 
                    `hsl(${40 + Math.random() * 20}, 70%, 50%)`;
                
                const color2 = Math.random() > 0.5 ? 
                    `hsl(${210 + Math.random() * 30}, 80%, 30%)` : 
                    `hsl(${50 + Math.random() * 10}, 80%, 30%)`;
                
                planets.push({
                    x: x,
                    y: y,
                    radius: radius,
                    color1: color1,
                    color2: color2,
                    rotation: Math.random() * Math.PI * 2,
                    rotationSpeed: (Math.random() - 0.5) * 0.002
                });
            }
        }
        
        // Draw planets
        function drawPlanets() {
            for (const planet of planets) {
                gameCtx.save();
                gameCtx.translate(planet.x, planet.y);
                gameCtx.rotate(planet.rotation);
                
                // Create gradient
                const gradient = gameCtx.createRadialGradient(
                    0, 0, planet.radius * 0.3,
                    0, 0, planet.radius
                );
                gradient.addColorStop(0, planet.color1);
                gradient.addColorStop(1, planet.color2);
                
                // Draw planet
                gameCtx.beginPath();
                gameCtx.arc(0, 0, planet.radius, 0, Math.PI * 2);
                gameCtx.fillStyle = gradient;
                gameCtx.fill();
                
                // Add some planet details
                gameCtx.fillStyle = 'rgba(0, 0, 0, 0.2)';
                for (let i = 0; i < 5; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const distance = Math.random() * planet.radius * 0.8;
                    const size = planet.radius * (0.1 + Math.random() * 0.2);
                    
                    gameCtx.beginPath();
                    gameCtx.arc(
                        Math.cos(angle) * distance,
                        Math.sin(angle) * distance,
                        size,
                        0,
                        Math.PI * 2
                    );
                    gameCtx.fill();
                }
                
                gameCtx.restore();
                
                // Update rotation
                planet.rotation += planet.rotationSpeed;
            }
        }
        
        // Show how to play
        function showHowToPlay() {
            alert(`How to Play Cosmic Cow Hunt:
            
- Shoot the flying cosmic cows by tapping/clicking on them
- Each hit gives you 100 points
- You have 5 shots before needing to reload (auto-reload after 2 seconds)
- Don't let too many cows escape or you'll lose lives
- Game lasts 60 seconds
- Try to get the highest score possible!
            
Good luck, space cowboy!`);
        }
        
        // End game
        function endGame() {
            gameRunning = false;
            clearInterval(gameTimeInterval);
            clearInterval(cowSpawnInterval);
            cancelAnimationFrame(animationFrameId);
            
            finalScoreElement.textContent = `Your Score: ${score}`;
            gameOverElement.style.display = 'flex';
            crosshair.style.display = 'none';
        }
        
        // Restart game
        function restartGame() {
            gameOverElement.style.display = 'none';
            startGame();
        }
        
        // Show menu
        function showMenu() {
            gameOverElement.style.display = 'none';
            menuElement.style.display = 'flex';
        }
        
        // Game objects
        let cows = [];
        let hitEffects = [];
        let planets = [];
        
        // Initialize game when loaded
        window.addEventListener('load', initGame);
    </script>
</body>
</html>