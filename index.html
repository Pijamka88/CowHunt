<!DOCTYPE html>
<html>
<head>
    <title>Bird Hunt</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            touch-action: none;
            background: #87CEEB;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #gameCanvas {
            background: #87CEEB;
        }
        #score {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 24px;
            color: white;
            font-family: Arial;
            text-shadow: 2px 2px 2px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div id="score">Score: 0</div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');

        let score = 0;
        let birds = [];
        let shots = [];
        let gameRunning = true;

        // Настройки игры
        const config = {
            birdSpeed: 2,
            spawnInterval: 1500,
            maxBirds: 10,
            birdRadius: 20
        };

        class Bird {
            constructor() {
                this.reset();
            }

            reset() {
                const side = Math.floor(Math.random() * 4);
                const angle = Math.random() * Math.PI/2 - Math.PI/4;
                
                switch(side) {
                    case 0: // Left
                        this.x = -config.birdRadius;
                        this.y = Math.random() * canvas.height;
                        this.vx = Math.cos(angle) * config.birdSpeed;
                        this.vy = Math.sin(angle) * config.birdSpeed;
                        break;
                    case 1: // Right
                        this.x = canvas.width + config.birdRadius;
                        this.y = Math.random() * canvas.height;
                        this.vx = -Math.cos(angle) * config.birdSpeed;
                        this.vy = Math.sin(angle) * config.birdSpeed;
                        break;
                    case 2: // Top
                        this.x = Math.random() * canvas.width;
                        this.y = -config.birdRadius;
                        this.vx = Math.sin(angle) * config.birdSpeed;
                        this.vy = Math.cos(angle) * config.birdSpeed;
                        break;
                    case 3: // Bottom
                        this.x = Math.random() * canvas.width;
                        this.y = canvas.height + config.birdRadius;
                        this.vx = Math.sin(angle) * config.birdSpeed;
                        this.vy = -Math.cos(angle) * config.birdSpeed;
                        break;
                }
                
                this.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                
                // Проверка выхода за границы
                if (this.x < -config.birdRadius || this.x > canvas.width + config.birdRadius ||
                    this.y < -config.birdRadius || this.y > canvas.height + config.birdRadius) {
                    this.reset();
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, config.birdRadius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // Глаз
                ctx.beginPath();
                ctx.arc(
                    this.x + config.birdRadius/3, 
                    this.y - config.birdRadius/3, 
                    config.birdRadius/5, 
                    0, 
                    Math.PI * 2
                );
                ctx.fillStyle = 'white';
                ctx.fill();
            }
        }

        class Shot {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.radius = 5;
                this.alpha = 1;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 0, 0, ${this.alpha})`;
                ctx.fill();
            }

            update() {
                this.radius += 1;
                this.alpha -= 0.1;
            }
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function gameLoop() {
            if (!gameRunning) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Обновление и отрисовка птиц
            birds.forEach(bird => {
                bird.update();
                bird.draw();
            });

            // Обновление и отрисовка выстрелов
            shots.forEach((shot, index) => {
                shot.update();
                shot.draw();
                if (shot.alpha <= 0) {
                    shots.splice(index, 1);
                }
            });

            requestAnimationFrame(gameLoop);
        }

        function spawnBird() {
            if (!gameRunning) return;
            if (birds.length < config.maxBirds) {
                birds.push(new Bird());
            }
            setTimeout(spawnBird, config.spawnInterval);
        }

        function checkHit(x, y) {
            birds.forEach((bird, index) => {
                const dx = x - bird.x;
                const dy = y - bird.y;
                const distance = Math.sqrt(dx*dx + dy*dy);
                
                if (distance < config.birdRadius) {
                    birds.splice(index, 1);
                    score += 100;
                    scoreElement.textContent = `Score: ${score}`;
                    shots.push(new Shot(bird.x, bird.y));
                }
            });
        }

        // Обработчики событий
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            checkHit(x, y);
            shots.push(new Shot(x, y));
        });

        window.addEventListener('resize', resizeCanvas);

        // Инициализация игры
        resizeCanvas();
        spawnBird();
        gameLoop();

        // Для интеграции с Telegram
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
    </script>
</body>
</html>