<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Cow Hunt</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            background: #000;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        
        #background {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #000428, #004e92);
            z-index: 0;
        }
        
        #stars {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            width: 8px;
            height: 8px;
            background: transparent;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }
        
        .star:before, .star:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: inherit;
            border-radius: inherit;
        }
        
        .star:before {
            transform: rotate(45deg);
        }
        
        .star:after {
            transform: rotate(90deg);
        }
        
        .blue-star {
            background: #4fc3f7;
            box-shadow: 0 0 10px #4fc3f7;
        }
        
        .gold-star {
            background: #ffd700;
            box-shadow: 0 0 10px #ffd700;
        }
        
        .planet {
            position: absolute;
            border-radius: 50%;
            z-index: 2;
        }
        
        #gameCanvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 3;
        }
        
        #uiContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 4;
            pointer-events: none;
        }
        
        #topUI {
            position: absolute;
            top: 10px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 2px black;
        }
        
        #bottomUI {
            position: absolute;
            bottom: 10px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 2px black;
        }
        
        #lives {
            display: flex;
            gap: 5px;
        }
        
        .heart {
            color: #ff5252;
        }
        
        #ammo {
            display: flex;
            gap: 5px;
        }
        
        .bullet {
            color: #ffeb3b;
        }
        
        #hitMiss {
            display: flex;
            gap: 10px;
        }
        
        #hitCount {
            color: #4caf50;
        }
        
        #missCount {
            color: #f44336;
        }
        
        #menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 5;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
        
        #menu h1 {
            font-size: 48px;
            margin-bottom: 30px;
            color: #ffeb3b;
            text-shadow: 0 0 10px #ff9800;
        }
        
        .menu-btn {
            background: linear-gradient(to bottom, #4fc3f7, #2196f3);
            border: none;
            color: white;
            padding: 12px 24px;
            margin: 10px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            pointer-events: auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            min-width: 200px;
            text-align: center;
        }
        
        .menu-btn:hover {
            background: linear-gradient(to bottom, #2196f3, #1976d2);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        #reloadMessage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 24px;
            z-index: 6;
            display: none;
            pointer-events: none;
        }
        
        #gameOver {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 7;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
        
        #gameOver h2 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #ffeb3b;
        }
        
        #finalScore {
            font-size: 24px;
            margin-bottom: 30px;
        }
        
        @keyframes twinkle {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="background"></div>
        <div id="stars"></div>
        <canvas id="gameCanvas"></canvas>
        <div id="uiContainer">
            <div id="topUI">
                <div id="score">Score: 0</div>
                <div id="time">Time: 60</div>
                <div id="lives">
                    <span class="heart">❤️</span>
                    <span class="heart">❤️</span>
                    <span class="heart">❤️</span>
                </div>
            </div>
            <div id="bottomUI">
                <div id="ammo">
                    <span class="bullet">•</span>
                    <span class="bullet">•</span>
                    <span class="bullet">•</span>
                    <span class="bullet">•</span>
                    <span class="bullet">•</span>
                </div>
                <div id="hitMiss">
                    <div id="hitCount">Hits: 0</div>
                    <div id="missCount">Miss: 0</div>
                </div>
            </div>
        </div>
        <div id="reloadMessage">Reloading...</div>
        <div id="menu">
            <h1>Cosmic Cow Hunt</h1>
            <button class="menu-btn" id="startBtn">Start Game</button>
            <button class="menu-btn" id="howToPlayBtn">How to Play</button>
        </div>
        <div id="gameOver">
            <h2>Game Over</h2>
            <div id="finalScore">Your score: 0</div>
            <button class="menu-btn" id="restartBtn">Play Again</button>
            <button class="menu-btn" id="menuBtn">Main Menu</button>
        </div>
    </div>

    <script>
        // Game constants
        const COW_SPAWN_RATE = 1500; // ms
        const GAME_DURATION = 60000; // 60 seconds
        const AMMO_CAPACITY = 5;
        const RELOAD_TIME = 2000; // 2 seconds
        const COW_SPEED_MIN = 1;
        const COW_SPEED_MAX = 3;
        const COW_SCORE = 10;
        const MAX_LIVES = 3;
        
        // Game variables
        let score = 0;
        let timeLeft = GAME_DURATION / 1000;
        let lives = MAX_LIVES;
        let ammo = AMMO_CAPACITY;
        let hits = 0;
        let misses = 0;
        let gameRunning = false;
        let gameTimeInterval;
        let cowSpawnInterval;
        let cows = [];
        let planets = [];
        let stars = [];
        let lastTimestamp = 0;
        let reloadTimeout;
        let isReloading = false;
        
        // DOM elements
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const timeElement = document.getElementById('time');
        const livesElement = document.getElementById('lives');
        const ammoElement = document.getElementById('ammo');
        const hitCountElement = document.getElementById('hitCount');
        const missCountElement = document.getElementById('missCount');
        const menuElement = document.getElementById('menu');
        const startBtn = document.getElementById('startBtn');
        const howToPlayBtn = document.getElementById('howToPlayBtn');
        const gameOverElement = document.getElementById('gameOver');
        const restartBtn = document.getElementById('restartBtn');
        const menuBtn = document.getElementById('menuBtn');
        const finalScoreElement = document.getElementById('finalScore');
        const reloadMessage = document.getElementById('reloadMessage');
        const starsContainer = document.getElementById('stars');
        
        // Resize canvas to full window
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // Initialize game
        function initGame() {
            resizeCanvas();
            createStars();
            createPlanets();
            
            // Event listeners
            window.addEventListener('resize', resizeCanvas);
            canvas.addEventListener('click', handleShoot);
            startBtn.addEventListener('click', startGame);
            howToPlayBtn.addEventListener('click', showHowToPlay);
            restartBtn.addEventListener('click', restartGame);
            menuBtn.addEventListener('click', showMenu);
            
            showMenu();
        }
        
        // Create stars for background
        function createStars() {
            starsContainer.innerHTML = '';
            const starCount = Math.floor((canvas.width * canvas.height) / 1000);
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                const starType = Math.random() > 0.7 ? 'gold-star' : 'blue-star';
                const size = Math.random() * 4 + 4;
                
                star.className = `star ${starType}`;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.animationDelay = `${Math.random() * 2}s`;
                
                starsContainer.appendChild(star);
            }
        }
        
        // Create planets for background
        function createPlanets() {
            planets = [];
            const planetCount = 3 + Math.floor(Math.random() * 3); // 3-5 planets
            
            for (let i = 0; i < planetCount; i++) {
                const size = Math.random() * 100 + 50;
                const x = Math.random() * (canvas.width - size);
                const y = Math.random() * (canvas.height - size);
                const color = Math.random() > 0.5 ? 'blue' : 'yellow';
                
                planets.push({
                    x, y, size, color,
                    rotation: Math.random() * Math.PI * 2,
                    rotationSpeed: (Math.random() - 0.5) * 0.01
                });
            }
        }
        
        // Draw planets
        function drawPlanets() {
            planets.forEach(planet => {
                ctx.save();
                ctx.translate(planet.x + planet.size / 2, planet.y + planet.size / 2);
                ctx.rotate(planet.rotation);
                
                // Create planet gradient
                const gradient = ctx.createRadialGradient(
                    -planet.size * 0.2, -planet.size * 0.2, planet.size * 0.1,
                    0, 0, planet.size / 2
                );
                
                if (planet.color === 'blue') {
                    gradient.addColorStop(0, '#1565c0');
                    gradient.addColorStop(0.5, '#1976d2');
                    gradient.addColorStop(1, '#2196f3');
                } else {
                    gradient.addColorStop(0, '#f57f17');
                    gradient.addColorStop(0.5, '#fbc02d');
                    gradient.addColorStop(1, '#ffeb3b');
                }
                
                // Draw planet
                ctx.beginPath();
                ctx.arc(0, 0, planet.size / 2, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                
                // Add some planet details
                ctx.beginPath();
                ctx.arc(planet.size * 0.3, planet.size * 0.2, planet.size * 0.1, 0, Math.PI * 2);
                ctx.fillStyle = planet.color === 'blue' ? '#0d47a1' : '#e65100';
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(-planet.size * 0.25, -planet.size * 0.15, planet.size * 0.15, 0, Math.PI * 2);
                ctx.fillStyle = planet.color === 'blue' ? '#0d47a1' : '#e65100';
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(planet.size * 0.1, -planet.size * 0.3, planet.size * 0.08, 0, Math.PI * 2);
                ctx.fillStyle = planet.color === 'blue' ? '#0d47a1' : '#e65100';
                ctx.fill();
                
                ctx.restore();
                
                // Update rotation
                planet.rotation += planet.rotationSpeed;
            });
        }
        
        // Cow class
        class Cow {
            constructor() {
                this.width = 80;
                this.height = 60;
                this.reset();
                this.wingAngle = 0;
                this.wingDirection = 1;
                this.wingSpeed = Math.random() * 0.05 + 0.05;
                this.alive = true;
                this.deathFrame = 0;
                this.maxDeathFrames = 10;
            }
            
            reset() {
                // Determine spawn side (0: top, 1: right, 2: bottom, 3: left)
                const side = Math.floor(Math.random() * 4);
                
                if (side === 0) { // Top
                    this.x = Math.random() * (canvas.width - this.width);
                    this.y = -this.height;
                    this.dx = (Math.random() - 0.5) * 2;
                    this.dy = Math.random() * COW_SPEED_MIN + (COW_SPEED_MAX - COW_SPEED_MIN);
                } else if (side === 1) { // Right
                    this.x = canvas.width;
                    this.y = Math.random() * (canvas.height - this.height);
                    this.dx = -(Math.random() * COW_SPEED_MIN + (COW_SPEED_MAX - COW_SPEED_MIN));
                    this.dy = (Math.random() - 0.5) * 2;
                } else if (side === 2) { // Bottom
                    this.x = Math.random() * (canvas.width - this.width);
                    this.y = canvas.height;
                    this.dx = (Math.random() - 0.5) * 2;
                    this.dy = -(Math.random() * COW_SPEED_MIN + (COW_SPEED_MAX - COW_SPEED_MIN));
                } else { // Left
                    this.x = -this.width;
                    this.y = Math.random() * (canvas.height - this.height);
                    this.dx = Math.random() * COW_SPEED_MIN + (COW_SPEED_MAX - COW_SPEED_MIN);
                    this.dy = (Math.random() - 0.5) * 2;
                }
                
                this.speed = Math.sqrt(this.dx * this.dx + this.dy * this.dy);
                this.scaleX = this.dx > 0 ? 1 : -1;
            }
            
            update() {
                if (this.alive) {
                    this.x += this.dx;
                    this.y += this.dy;
                    
                    // Wing animation
                    this.wingAngle += this.wingSpeed * this.wingDirection;
                    if (Math.abs(this.wingAngle) > 0.5) {
                        this.wingDirection *= -1;
                    }
                    
                    // Check if out of bounds
                    if (this.x < -this.width * 2 || this.x > canvas.width + this.width * 2 ||
                        this.y < -this.height * 2 || this.y > canvas.height + this.height * 2) {
                        return false; // Remove this cow
                    }
                } else {
                    this.deathFrame++;
                    if (this.deathFrame >= this.maxDeathFrames) {
                        return false; // Remove this cow
                    }
                }
                
                return true; // Keep this cow
            }
            
            draw(ctx) {
                ctx.save();
                ctx.translate(this.x + this.width / 2, this.y + this.height / 2);
                ctx.scale(this.scaleX, 1);
                
                if (this.alive) {
                    // Draw cow body
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.ellipse(0, 0, this.width / 2, this.height / 2, 0, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw cow head
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.ellipse(this.width / 4, -this.height / 6, this.width / 4, this.height / 4, 0, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw cow spots
                    ctx.fillStyle = '#d3d3d3';
                    ctx.beginPath();
                    ctx.ellipse(-this.width / 6, -this.height / 8, this.width / 8, this.height / 6, 0, 0, Math.PI * 2);
                    ctx.fill();
                    
                    ctx.beginPath();
                    ctx.ellipse(this.width / 6, this.height / 8, this.width / 6, this.height / 8, 0, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw cow eyes
                    ctx.fillStyle = '#000000';
                    ctx.beginPath();
                    ctx.arc(this.width / 3, -this.height / 6, 3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Draw cow mouth
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.arc(this.width / 3 + 5, -this.height / 8, 5, 0, Math.PI);
                    ctx.stroke();
                    
                    // Draw wings
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    
                    // Left wing
                    ctx.save();
                    ctx.rotate(this.wingAngle);
                    ctx.beginPath();
                    ctx.moveTo(-this.width / 3, 0);
                    ctx.lineTo(-this.width / 2, -this.height / 3);
                    ctx.lineTo(-this.width / 4, -this.height / 4);
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                    
                    // Right wing
                    ctx.save();
                    ctx.rotate(-this.wingAngle);
                    ctx.beginPath();
                    ctx.moveTo(-this.width / 3, 0);
                    ctx.lineTo(-this.width / 2, this.height / 3);
                    ctx.lineTo(-this.width / 4, this.height / 4);
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                } else {
                    // Draw dead cow (explosion animation)
                    const progress = this.deathFrame / this.maxDeathFrames;
                    const pieces = [
                        { x: -20, y: -20, rotation: progress * Math.PI * 2 },
                        { x: 20, y: -10, rotation: progress * Math.PI * 1.5 },
                        { x: -15, y: 15, rotation: progress * Math.PI },
                        { x: 10, y: 20, rotation: progress * Math.PI * 0.5 }
                    ];
                    
                    pieces.forEach(piece => {
                        ctx.save();
                        ctx.translate(piece.x * progress, piece.y * progress);
                        ctx.rotate(piece.rotation);
                        
                        ctx.fillStyle = '#ffffff';
                        ctx.beginPath();
                        ctx.ellipse(0, 0, this.width / 6, this.height / 8, 0, 0, Math.PI * 2);
                        ctx.fill();
                        
                        // Add some details to pieces
                        ctx.fillStyle = '#d3d3d3';
                        ctx.beginPath();
                        ctx.arc(5, 5, 3, 0, Math.PI * 2);
                        ctx.fill();
                        
                        ctx.restore();
                    });
                    
                    // Draw explosion effect
                    ctx.fillStyle = `rgba(255, 165, 0, ${1 - progress})`;
                    ctx.beginPath();
                    ctx.arc(0, 0, 30 * progress, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.restore();
            }
            
            isHit(x, y) {
                if (!this.alive) return false;
                
                // Simple ellipse hit detection
                const centerX = this.x + this.width / 2;
                const centerY = this.y + this.height / 2;
                const a = this.width / 2;
                const b = this.height / 2;
                
                const normalizedX = ((x - centerX) * this.scaleX) / a;
                const normalizedY = (y - centerY) / b;
                
                return (normalizedX * normalizedX + normalizedY * normalizedY) <= 1;
            }
            
            kill() {
                this.alive = false;
                this.deathFrame = 0;
            }
        }
        
        // Handle shooting
        function handleShoot(e) {
            if (!gameRunning || isReloading) return;
            
            // Get click position
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if hit any cow
            let hit = false;
            for (let i = 0; i < cows.length; i++) {
                if (cows[i].isHit(x, y)) {
                    cows[i].kill();
                    score += COW_SCORE;
                    hits++;
                    hit = true;
                    scoreElement.textContent = `Score: ${score}`;
                    hitCountElement.textContent = `Hits: ${hits}`;
                    break;
                }
            }
            
            if (!hit) {
                misses++;
                missCountElement.textContent = `Miss: ${misses}`;
            }
            
            // Decrease ammo
            ammo--;
            updateAmmoDisplay();
            
            // Check if need to reload
            if (ammo <= 0) {
                startReload();
            }
            
            // Draw gunshot effect
            drawGunshot(x, y);
        }
        
        // Draw gunshot effect
        function drawGunshot(x, y) {
            ctx.save();
            
            // Flash
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Bullet trace
            ctx.strokeStyle = '#ffeb3b';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, canvas.height);
            ctx.lineTo(x, y);
            ctx.stroke();
            
            // Hit effect if hit something
            if (false) { // We don't know here if we hit, but could pass it as param
                ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
                ctx.beginPath();
                ctx.arc(x, y, 15, 0, Math.PI * 2);
                ctx.fill();
            }
            
            ctx.restore();
        }
        
        // Update ammo display
        function updateAmmoDisplay() {
            ammoElement.innerHTML = '';
            for (let i = 0; i < AMMO_CAPACITY; i++) {
                const bullet = document.createElement('span');
                bullet.className = 'bullet';
                bullet.textContent = i < ammo ? '•' : '◦';
                ammoElement.appendChild(bullet);
            }
        }
        
        // Start reload process
        function startReload() {
            isReloading = true;
            reloadMessage.style.display = 'block';
            reloadMessage.style.animation = 'fadeIn 0.3s';
            
            setTimeout(() => {
                reloadMessage.style.animation = 'fadeOut 0.3s';
                setTimeout(() => {
                    reloadMessage.style.display = 'none';
                    ammo = AMMO_CAPACITY;
                    updateAmmoDisplay();
                    isReloading = false;
                }, 300);
            }, RELOAD_TIME);
        }
        
        // Update game time
        function updateTime() {
            timeLeft--;
            timeElement.textContent = `Time: ${timeLeft}`;
            
            if (timeLeft <= 0) {
                endGame();
            }
        }
        
        // Spawn a new cow
        function spawnCow() {
            if (gameRunning && cows.length < 10) { // Limit number of cows
                cows.push(new Cow());
            }
        }
        
        // Update lives display
        function updateLivesDisplay() {
            livesElement.innerHTML = '';
            for (let i = 0; i < MAX_LIVES; i++) {
                const heart = document.createElement('span');
                heart.className = 'heart';
                heart.textContent = i < lives ? '❤️' : '♡';
                livesElement.appendChild(heart);
            }
        }
        
        // Cow escaped (reached edge of screen)
        function cowEscaped() {
            lives--;
            updateLivesDisplay();
            
            if (lives <= 0) {
                endGame();
            }
        }
        
        // Start game
        function startGame() {
            // Reset game state
            score = 0;
            timeLeft = GAME_DURATION / 1000;
            lives = MAX_LIVES;
            ammo = AMMO_CAPACITY;
            hits = 0;
            misses = 0;
            cows = [];
            
            // Update UI
            scoreElement.textContent = `Score: ${score}`;
            timeElement.textContent = `Time: ${timeLeft}`;
            hitCountElement.textContent = `Hits: ${hits}`;
            missCountElement.textContent = `Miss: ${misses}`;
            updateLivesDisplay();
            updateAmmoDisplay();
            
            // Start game loops
            gameRunning = true;
            gameTimeInterval = setInterval(updateTime, 1000);
            cowSpawnInterval = setInterval(spawnCow, COW_SPAWN_RATE);
            
            // Hide menu
            menuElement.style.display = 'none';
            
            // Start game loop
            lastTimestamp = performance.now();
            requestAnimationFrame(gameLoop);
        }
        
        // End game
        function endGame() {
            gameRunning = false;
            clearInterval(gameTimeInterval);
            clearInterval(cowSpawnInterval);
            clearTimeout(reloadTimeout);
            
            // Show game over screen
            finalScoreElement.textContent = `Your score: ${score}`;
            gameOverElement.style.display = 'flex';
        }
        
        // Restart game
        function restartGame() {
            gameOverElement.style.display = 'none';
            startGame();
        }
        
        // Show menu
        function showMenu() {
            menuElement.style.display = 'flex';
            gameOverElement.style.display = 'none';
        }
        
        // Show how to play
        function showHowToPlay() {
            alert("How to Play:\n\n- Shoot the flying cosmic cows before they escape!\n- You have 5 shots before needing to reload\n- Don't let too many cows escape or you'll lose lives\n- The game lasts 60 seconds\n- Try to get the highest score possible!");
        }
        
        // Main game loop
        function gameLoop(timestamp) {
            if (!gameRunning) return;
            
            const deltaTime = timestamp - lastTimestamp;
            lastTimestamp = timestamp;
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background elements
            drawPlanets();
            
            // Update and draw cows
            for (let i = cows.length - 1; i >= 0; i--) {
                const keepCow = cows[i].update();
                
                if (!keepCow) {
                    if (cows[i].alive) {
                        cowEscaped();
                    }
                    cows.splice(i, 1);
                } else {
                    cows[i].draw(ctx);
                }
            }
            
            requestAnimationFrame(gameLoop);
        }
        
        // Initialize the game when the page loads
        window.onload = initGame;
    </script>
</body>
</html>