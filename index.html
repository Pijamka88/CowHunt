<!DOCTYPE html>
<html>
<head>
    <title>Space Cow Invasion</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(45deg, #2a0a4a, #1a043a);
            color: white;
            font-family: 'Arial', sans-serif;
            touch-action: manipulation;
            overflow: hidden;
        }

        #mainMenu, #gameScreen, #howToPlay, #highScores {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .menuButton {
            background: #4a148c;
            border: 2px solid #7c43bd;
            color: white;
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.2em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .menuButton:hover {
            background: #7c43bd;
        }

        #gameUI {
            position: absolute;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
        }

        #stats {
            position: absolute;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: space-around;
        }

        .cow {
            position: absolute;
            transition: transform 0.3s;
        }

        .crosshair {
            position: absolute;
            width: 30px;
            height: 30px;
            background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" stroke="%23FF4081" stroke-width="4" fill="none"/><line x1="50" y1="10" x2="50" y2="30" stroke="%23FF4081" stroke-width="4"/><line x1="50" y1="70" x2="50" y2="90" stroke="%23FF4081" stroke-width="4"/><line x1="10" y1="50" x2="30" y2="50" stroke="%23FF4081" stroke-width="4"/><line x1="70" y1="50" x2="90" y2="50" stroke="%23FF4081" stroke-width="4"/></svg>');
            pointer-events: none;
            transform: translate(-50%, -50%);
        }

        .reloading {
            color: #FF4081;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="mainMenu">
        <button class="menuButton" onclick="showScreen('gameScreen')">Start Mission</button>
        <button class="menuButton" onclick="showScreen('howToPlay')">How to Play</button>
        <button class="menuButton" onclick="showHighScores()">High Scores</button>
    </div>

    <div id="gameScreen">
        <div id="gameUI">
            <div>Score: <span id="score">0</span></div>
            <div>Time: <span id="timer">60</span>s</div>
            <div>Lives: <span id="lives">❤️❤️❤️</span></div>
        </div>
        <div id="stats">
            <div>Ammo: <span id="ammo">5</span></div>
            <div>Hits: <span id="hits">0</span></div>
            <div>Misses: <span id="misses">0</span></div>
        </div>
        <div id="crosshair" class="crosshair"></div>
    </div>

    <div id="howToPlay">
        <h2>Mission Briefing</h2>
        <p>1. Destroy alien cows in 60 seconds</p>
        <p>2. 5 shots before reload</p>
        <p>3. Different cow types give various points</p>
        <button class="menuButton" onclick="showScreen('mainMenu')">Back</button>
    </div>

    <div id="highScores">
        <h2>Top Pilots</h2>
        <ol id="leaderboard"></ol>
        <button class="menuButton" onclick="showScreen('mainMenu')">Back</button>
    </div>

<script>
let gameState = {
    score: 0,
    ammo: 5,
    hits: 0,
    misses: 0,
    lives: 3,
    timeLeft: 60,
    isReloading: false,
    cows: [],
    gameInterval: null,
    cowInterval: null
};

const cowTypes = [
    { color: '#FF4081', points: 100, speed: 3 },
    { color: '#00BCD4', points: 200, speed: 5 },
    { color: '#FFC107', points: 300, speed: 7 }
];

function showScreen(screenId) {
    document.querySelectorAll('div[id]').forEach(div => div.style.display = 'none');
    document.getElementById(screenId).style.display = 'flex';
    if(screenId === 'gameScreen') startGame();
}

function startGame() {
    resetGameState();
    gameState.gameInterval = setInterval(updateGame, 1000);
    gameState.cowInterval = setInterval(createCow, 1500);
    document.addEventListener('mousemove', updateCrosshair);
    document.addEventListener('click', handleShot);
}

function createCow() {
    const cow = document.createElement('div');
    const type = cowTypes[Math.floor(Math.random() * cowTypes.length)];
    
    cow.className = 'cow';
    cow.style.left = Math.random() * 80 + 10 + '%';
    cow.style.top = '-50px';
    cow.innerHTML = `
        <div style="width:40px;height:20px;background:${type.color};position:relative;">
            <div style="width:20px;height:20px;background:${type.color};border-radius:50%;position:absolute;left:-10px;"></div>
            <div style="width:10px;height:30px;background:${type.color};position:absolute;left:15px;top:-10px;transform:rotate(45deg);"></div>
            <div style="width:10px;height:30px;background:${type.color};position:absolute;right:15px;top:-10px;transform:rotate(-45deg);"></div>
        </div>
    `;
    
    document.getElementById('gameScreen').appendChild(cow);
    gameState.cows.push({
        element: cow,
        type: type,
        x: parseFloat(cow.style.left),
        y: -50,
        angle: Math.random() * Math.PI * 2
    });
}

function updateGame() {
    gameState.timeLeft--;
    document.getElementById('timer').textContent = gameState.timeLeft;

    gameState.cows.forEach((cow, index) => {
        cow.y += cow.type.speed * 0.5;
        cow.x += Math.sin(cow.angle) * 2;
        cow.angle += 0.1;
        
        cow.element.style.transform = `translate(${cow.x}%, ${cow.y}px)`;
        
        if(cow.y > window.innerHeight) {
            cow.element.remove();
            gameState.cows.splice(index, 1);
        }
    });

    if(gameState.timeLeft <= 0) endGame();
}

function handleShot(e) {
    if(gameState.isReloading || gameState.ammo <= 0) return;

    gameState.ammo--;
    document.getElementById('ammo').textContent = gameState.ammo;

    const rect = document.getElementById('crosshair').getBoundingClientRect();
    const shotX = rect.left + 15;
    const shotY = rect.top + 15;

    let hit = false;
    gameState.cows.forEach((cow, index) => {
        const cowRect = cow.element.getBoundingClientRect();
        if(shotX > cowRect.left && shotX < cowRect.right &&
           shotY > cowRect.top && shotY < cowRect.bottom) {
            cow.element.remove();
            gameState.cows.splice(index, 1);
            gameState.score += cow.type.points;
            gameState.hits++;
            hit = true;
        }
    });

    hit ? document.getElementById('hits').textContent = gameState.hits : 
          document.getElementById('misses').textContent = ++gameState.misses;
    
    document.getElementById('score').textContent = gameState.score;
    
    if(gameState.ammo === 0) startReload();
}

function startReload() {
    gameState.isReloading = true;
    document.getElementById('crosshair').classList.add('reloading');
    document.getElementById('crosshair').style.backgroundImage = 'none';
    setTimeout(() => {
        gameState.ammo = 5;
        gameState.isReloading = false;
        document.getElementById('ammo').textContent = 5;
        document.getElementById('crosshair').classList.remove('reloading');
        document.getElementById('crosshair').style.backgroundImage = 
            'url("data:image/svg+xml;utf8,<svg viewBox=\'0 0 100 100\' xmlns=\'http://www.w3.org/2000/svg\'><circle cx=\'50\' cy=\'50\' r=\'40\' stroke=\'%23FF4081\' stroke-width=\'4\' fill=\'none\'/><line x1=\'50\' y1=\'10\' x2=\'50\' y2=\'30\' stroke=\'%23FF4081\' stroke-width=\'4\'/><line x1=\'50\' y1=\'70\' x2=\'50\' y2=\'90\' stroke=\'%23FF4081\' stroke-width=\'4\'/><line x1=\'10\' y1=\'50\' x2=\'30\' y2=\'50\' stroke=\'%23FF4081\' stroke-width=\'4\'/><line x1=\'70\' y1=\'50\' x2=\'90\' y2=\'50\' stroke=\'%23FF4081\' stroke-width=\'4\'/></svg>")';
    }, 2000);
}

function updateCrosshair(e) {
    const crosshair = document.getElementById('crosshair');
    crosshair.style.left = e.clientX + 'px';
    crosshair.style.top = e.clientY + 'px';
}

function endGame() {
    clearInterval(gameState.gameInterval);
    clearInterval(gameState.cowInterval);
    document.removeEventListener('mousemove', updateCrosshair);
    document.removeEventListener('click', handleShot);
    updateLeaderboard();
    showScreen('highScores');
}

function resetGameState() {
    gameState = {
        score: 0,
        ammo: 5,
        hits: 0,
        misses: 0,
        lives: 3,
        timeLeft: 60,
        isReloading: false,
        cows: [],
        gameInterval: null,
        cowInterval: null
    };
    document.getElementById('score').textContent = '0';
    document.getElementById('ammo').textContent = '5';
    document.getElementById('hits').textContent = '0';
    document.getElementById('misses').textContent = '0';
    document.getElementById('lives').textContent = '❤️❤️❤️';
    document.querySelectorAll('.cow').forEach(cow => cow.remove());
}

function showHighScores() {
    const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
    const list = document.getElementById('leaderboard');
    list.innerHTML = leaderboard.slice(0,5).map(entry => 
        `<li>${entry.name}: ${entry.score}`).join('');
    showScreen('highScores');
}

function updateLeaderboard() {
    const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
    const name = prompt('Enter your callsign:');
    leaderboard.push({ name, score: gameState.score });
    leaderboard.sort((a,b) => b.score - a.score);
    localStorage.setItem('leaderboard', JSON.stringify(leaderboard.slice(0,5)));
}

showScreen('mainMenu');
</script>
</body>
</html>