<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –ö—Ä—ã–ª–∞—Ç—ã–µ –ö–æ—Ä–æ–≤—ã</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #0d1117;
      color: white;
      font-family: sans-serif;
    }

    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(#001f3f, #0074D9);
      width: 100vw;
      height: 100vh;
    }

    #menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 10;
      background: rgba(0,0,0,0.7);
      padding: 30px;
      border-radius: 10px;
    }

    #menu button {
      padding: 10px 20px;
      font-size: 18px;
      margin-top: 10px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background: #0074D9;
      color: white;
    }
  </style>
</head>
<body>
<div id="menu">
  <h1>üõ∏ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –ö–æ—Ä–æ–≤—ã üõ∏</h1>
  <p>–ù–∞–∂–º–∏ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!</p>
  <button onclick="startGame()">–ò–≥—Ä–∞—Ç—å</button>
</div>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let width, height;
function resize() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

let gameRunning = false;
let cows = [];
let particles = [];
let score = 0;
let level = 1;
let direction = 1; // 1 - right, -1 - left
let speed = 1;

// === DRAWING HELPERS ===
function drawCow(cow) {
  ctx.save();
  ctx.translate(cow.x, cow.y);
  ctx.scale(cow.direction, 1);

  // –¢–µ–ª–æ
  ctx.fillStyle = "#333";
  ctx.beginPath();
  ctx.ellipse(0, 0, 30, 20, 0, 0, Math.PI * 2);
  ctx.fill();

  // –ù–æ–≥–∏
  ctx.fillStyle = "#222";
  for (let i = 0; i < 4; i++) {
    let legX = -20 + i * 13;
    ctx.fillRect(legX, 15, 4, 10);
  }

  // –ì–æ–ª–æ–≤–∞
  ctx.fillStyle = "#444";
  ctx.beginPath();
  ctx.arc(20, -10, 12, 0, Math.PI * 2);
  ctx.fill();

  // –®–ª–µ–º
  ctx.strokeStyle = "cyan";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.arc(20, -10, 14, 0, Math.PI * 2);
  ctx.stroke();

  // –†–æ–∂–∫–∏
  ctx.beginPath();
  ctx.moveTo(12, -20);
  ctx.lineTo(10, -30);
  ctx.moveTo(28, -20);
  ctx.lineTo(30, -30);
  ctx.strokeStyle = "#ffcc00";
  ctx.lineWidth = 2;
  ctx.stroke();

  // –ì–ª–∞–∑–∞
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(16, -12, 4, 0, Math.PI * 2);
  ctx.arc(24, -12, 4, 0, Math.PI * 2);
  ctx.fill();

  ctx.restore();
}

function drawParticle(p) {
  ctx.beginPath();
  ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
  ctx.fillStyle = `rgba(${p.color}, ${p.alpha})`;
  ctx.fill();
}

function spawnCows() {
  cows = [];
  for (let row = 0; row < 3; row++) {
    for (let col = 0; col < 5; col++) {
      cows.push({
        x: 50 + col * 80,
        y: 50 + row * 60,
        vx: speed * direction,
        alive: true,
        direction: direction
      });
    }
  }
}

function explode(x, y) {
  for (let i = 0; i < 20; i++) {
    particles.push({
      x, y,
      vx: (Math.random() - 0.5) * 6,
      vy: (Math.random() - 0.5) * 6,
      size: Math.random() * 4 + 2,
      life: 1,
      color: "255,255,255",
      alpha: 1
    });
  }
}

function startGame() {
  document.getElementById("menu").style.display = "none";
  gameRunning = true;
  score = 0;
  level = 1;
  speed = 1.5;
  direction = 1;
  spawnCows();
  loop();
}

canvas.addEventListener("click", e => {
  if (!gameRunning) return;
  const rect = canvas.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;

  for (let cow of cows) {
    if (!cow.alive) continue;
    const dx = cow.x * cow.direction - mouseX;
    const dy = cow.y - mouseY;
    if (Math.sqrt(dx*dx + dy*dy) < 30) {
      cow.alive = false;
      cow.fallY = cow.y;
      explode(mouseX, mouseY);
      score += 10;
      if (score % 50 === 0) nextLevel();
    }
  }
});

function nextLevel() {
  level++;
  speed += 0.5;
  direction *= -1;
  spawnCows();
}

function update() {
  // Update cows
  let moveDown = false;
  for (let cow of cows) {
    if (!cow.alive) continue;
    cow.x += cow.vx;
    cow.direction = cow.vx > 0 ? 1 : -1;
    if (cow.x > width - 30 || cow.x < 30) {
      moveDown = true;
    }
  }
  if (moveDown) {
    for (let cow of cows) {
      if (!cow.alive) continue;
      cow.vx *= -1;
      cow.y += 20;
    }
  }

  // Particles
  particles = particles.filter(p => p.life > 0);
  for (let p of particles) {
    p.x += p.vx;
    p.y += p.vy;
    p.life -= 0.02;
    p.alpha = p.life;
  }
}

function draw() {
  ctx.clearRect(0, 0, width, height);

  // Score
  ctx.fillStyle = "white";
  ctx.font = "20px sans-serif";
  ctx.fillText(`–û—á–∫–∏: ${score} | –£—Ä–æ–≤–µ–Ω—å: ${level}`, 10, 30);

  for (let cow of cows) {
    if (cow.alive) {
      drawCow(cow);
    } else {
      // Falling animation
      ctx.save();
      ctx.translate(cow.x * cow.direction, cow.fallY);
      ctx.scale(cow.direction, 1);
      ctx.rotate(Math.PI / 4);
      ctx.fillStyle = "#333";
      ctx.fillRect(-30, 0, 60, 40);
      ctx.restore();
      cow.fallY += 5;
      if (cow.fallY > height) cow.alive = true;
    }
  }

  particles.forEach(drawParticle);
}

function loop() {
  if (!gameRunning) return;
  update();
  draw();
  requestAnimationFrame(loop);
}
</script>
</body>
</html>