<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –¢–∞–º–∞–≥–æ—á–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            background-color: #50a8eb;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3a7bb8;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .pet-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        .pet {
            border: 2px solid #50a8eb;
            border-radius: 10px;
            padding: 15px;
            width: 200px;
            text-align: center;
            background-color: #f9f9f9;
        }
        .pet-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }
        .pet-stats {
            text-align: left;
            margin-top: 10px;
        }
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 5px 0;
        }
        .progress-bar {
            height: 10px;
            border-radius: 5px;
            background-color: #4caf50;
        }
        .hunger {
            background-color: #ff9800;
        }
        .energy {
            background-color: #2196f3;
        }
        .happiness {
            background-color: #e91e63;
        }
        .level {
            background-color: #9c27b0;
        }
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-top: 10px;
        }
        .action-buttons button {
            padding: 5px 10px;
            font-size: 14px;
        }
        .back-button {
            background-color: #f44336;
            margin-top: 20px;
        }
        .back-button:hover {
            background-color: #d32f2f;
        }
        .hidden {
            display: none;
        }
        .evolution-notice {
            color: #9c27b0;
            font-weight: bold;
            margin: 10px 0;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="main-menu">
            <h1>–≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –¢–∞–º–∞–≥–æ—á–∏</h1>
            <p>–í—ã—Ä–∞—Å—Ç–∏—Ç–µ —Å–≤–æ–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞, —É—Ö–∞–∂–∏–≤–∞–π—Ç–µ –∑–∞ –Ω–∏–º –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ, –∫–∞–∫ –æ–Ω —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ –¥–µ–ª–µ–Ω–∏–µ!</p>
            <div class="menu">
                <button id="new-game-btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button id="continue-game-btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É</button>
                <button id="how-to-play-btn">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ–±—É—á–µ–Ω–∏—è -->
        <div id="how-to-play" class="hidden">
            <h2>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h2>
            <p>1. –£ –≤–∞—Å –µ—Å—Ç—å –ø–∏—Ç–æ–º–µ—Ü —Å —á–µ—Ç—ã—Ä—å–º—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:</p>
            <ul>
                <li><strong>–ì–æ–ª–æ–¥</strong> - –∫–æ—Ä–º–∏—Ç–µ –ø–∏—Ç–æ–º—Ü–∞, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –≥–æ–ª–æ–¥</li>
                <li><strong>–≠–Ω–µ—Ä–≥–∏—è</strong> - –¥–∞–≤–∞–π—Ç–µ –ø–∏—Ç–æ–º—Ü—É –æ—Ç–¥—ã—Ö–∞—Ç—å, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é</li>
                <li><strong>–°—á–∞—Å—Ç—å–µ</strong> - –∏–≥—Ä–∞–π—Ç–µ —Å –ø–∏—Ç–æ–º—Ü–µ–º, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á–∞—Å—Ç—å–µ</li>
                <li><strong>–£—Ä–æ–≤–µ–Ω—å</strong> - —Ä–∞—Å—Ç—ë—Ç —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º —É—Ö–æ–¥–µ</li>
            </ul>
            <p>2. –ö–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å –ø–∏—Ç–æ–º—Ü–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º–∞, –æ–Ω –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–≤–∞ –Ω–æ–≤—ã—Ö –ø–∏—Ç–æ–º—Ü–∞.</p>
            <p>3. –í—ã –º–æ–∂–µ—Ç–µ —É—Ö–∞–∂–∏–≤–∞—Ç—å –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∏—Ç–æ–º—Ü–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</p>
            <p>4. –ò–≥—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.</p>
            <button id="back-from-help" class="back-button">–ù–∞–∑–∞–¥</button>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game-screen" class="hidden">
            <h2>–í–∞—à–∏ –ø–∏—Ç–æ–º—Ü—ã</h2>
            <div id="pets-container" class="pet-container"></div>
            <button id="back-to-menu" class="back-button">–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ -->
        <div id="new-pet-screen" class="hidden">
            <h2>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</h2>
            <p>–î–∞–π—Ç–µ –∏–º—è –≤–∞—à–µ–º—É –ø–µ—Ä–≤–æ–º—É –ø–∏—Ç–æ–º—Ü—É:</p>
            <input type="text" id="pet-name-input" placeholder="–ò–º—è –ø–∏—Ç–æ–º—Ü–∞" maxlength="20">
            <button id="create-pet-btn">–°–æ–∑–¥–∞—Ç—å</button>
            <button id="cancel-create-pet" class="back-button">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        const MAX_HUNGER = 100;
        const MAX_ENERGY = 100;
        const MAX_HAPPINESS = 100;
        const MAX_LEVEL = 10;
        
        const HUNGER_RATE = 2; // –°–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≥–æ–ª–æ–¥–∞
        const ENERGY_RATE = 1.5; // –°–∫–æ—Ä–æ—Å—Ç—å —É–º–µ–Ω—å—à–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏
        const HAPPINESS_RATE = 1; // –°–∫–æ—Ä–æ—Å—Ç—å —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å—á–∞—Å—Ç—å—è
        const LEVEL_RATE = 0.05; // –°–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è (–ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º —É—Ö–æ–¥–µ)
        
        const FEED_AMOUNT = 30; // –°–∫–æ–ª—å–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ—Ä–º–ª–µ–Ω–∏–µ
        const REST_AMOUNT = 40; // –°–∫–æ–ª—å–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Ç–¥—ã—Ö
        const PLAY_AMOUNT = 25; // –°–∫–æ–ª—å–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–≥—Ä–∞
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            pets: [],
            lastUpdate: Date.now(),
            gameStarted: false
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const mainMenu = document.getElementById('main-menu');
        const howToPlay = document.getElementById('how-to-play');
        const gameScreen = document.getElementById('game-screen');
        const newPetScreen = document.getElementById('new-pet-screen');
        const petsContainer = document.getElementById('pets-container');
        
        // –ö–Ω–æ–ø–∫–∏
        const newGameBtn = document.getElementById('new-game-btn');
        const continueGameBtn = document.getElementById('continue-game-btn');
        const howToPlayBtn = document.getElementById('how-to-play-btn');
        const backFromHelpBtn = document.getElementById('back-from-help');
        const backToMenuBtn = document.getElementById('back-to-menu');
        const createPetBtn = document.getElementById('create-pet-btn');
        const cancelCreatePetBtn = document.getElementById('cancel-create-pet');
        const petNameInput = document.getElementById('pet-name-input');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        newGameBtn.addEventListener('click', startNewGame);
        continueGameBtn.addEventListener('click', continueGame);
        howToPlayBtn.addEventListener('click', showHowToPlay);
        backFromHelpBtn.addEventListener('click', showMainMenu);
        backToMenuBtn.addEventListener('click', () => {
            saveGame();
            showMainMenu();
        });
        createPetBtn.addEventListener('click', createNewPet);
        cancelCreatePetBtn.addEventListener('click', showMainMenu);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –∏–≥—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            loadGame();
            
            if (gameState.gameStarted && gameState.pets.length > 0) {
                continueGameBtn.disabled = false;
            } else {
                continueGameBtn.disabled = true;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App
            tg.expand();
            tg.MainButton.hide();
        });
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function startNewGame() {
            gameState = {
                pets: [],
                lastUpdate: Date.now(),
                gameStarted: true
            };
            showNewPetScreen();
        }
        
        function continueGame() {
            if (gameState.pets.length === 0) {
                alert('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤!');
                return;
            }
            
            updateGame();
            renderPets();
            showGameScreen();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            startGameLoop();
        }
        
        function showMainMenu() {
            mainMenu.classList.remove('hidden');
            howToPlay.classList.add('hidden');
            gameScreen.classList.add('hidden');
            newPetScreen.classList.add('hidden');
        }
        
        function showHowToPlay() {
            mainMenu.classList.add('hidden');
            howToPlay.classList.remove('hidden');
        }
        
        function showGameScreen() {
            mainMenu.classList.add('hidden');
            gameScreen.classList.remove('hidden');
        }
        
        function showNewPetScreen() {
            mainMenu.classList.add('hidden');
            newPetScreen.classList.remove('hidden');
            petNameInput.value = '';
            petNameInput.focus();
        }
        
        function createNewPet() {
            const name = petNameInput.value.trim();
            if (name === '') {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–∏—Ç–æ–º—Ü–∞!');
                return;
            }
            
            const newPet = {
                id: Date.now().toString(),
                name: name,
                hunger: MAX_HUNGER / 2,
                energy: MAX_ENERGY / 2,
                happiness: MAX_HAPPINESS / 2,
                level: 1,
                lastFed: Date.now(),
                lastRested: Date.now(),
                lastPlayed: Date.now(),
                createdAt: Date.now()
            };
            
            gameState.pets.push(newPet);
            gameState.lastUpdate = Date.now();
            
            saveGame();
            updateGame();
            renderPets();
            showGameScreen();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            startGameLoop();
        }
        
        function updateGame() {
            const now = Date.now();
            const timePassed = (now - gameState.lastUpdate) / 1000; // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            gameState.lastUpdate = now;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
            for (let pet of gameState.pets) {
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≥–æ–ª–æ–¥
                pet.hunger = Math.max(0, pet.hunger - HUNGER_RATE * timePassed);
                
                // –£–º–µ–Ω—å—à–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é
                pet.energy = Math.max(0, pet.energy - ENERGY_RATE * timePassed);
                
                // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–∞—Å—Ç—å–µ
                pet.happiness = Math.max(0, pet.happiness - HAPPINESS_RATE * timePassed);
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å, –µ—Å–ª–∏ –ø–∏—Ç–æ–º–µ—Ü —É—Ö–æ–∂–µ–Ω
                if (pet.hunger > 30 && pet.energy > 20 && pet.happiness > 25) {
                    pet.level = Math.min(MAX_LEVEL, pet.level + LEVEL_RATE * timePassed);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∏–≥ –ª–∏ –ø–∏—Ç–æ–º–µ—Ü –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–ª—è –¥–µ–ª–µ–Ω–∏—è
                if (pet.level >= MAX_LEVEL) {
                    dividePet(pet);
                }
            }
            
            // –£–¥–∞–ª—è–µ–º –ø–∏—Ç–æ–º—Ü–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ "—É–º–µ—Ä–ª–∏" (–µ—Å–ª–∏ –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –Ω—É–ª–µ)
            gameState.pets = gameState.pets.filter(pet => 
                pet.hunger > 0 || pet.energy > 0 || pet.happiness > 0
            );
            
            // –ï—Å–ª–∏ –ø–∏—Ç–æ–º—Ü–µ–≤ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            if (gameState.pets.length === 0 && gameState.gameStarted) {
                alert('–í—Å–µ –≤–∞—à–∏ –ø–∏—Ç–æ–º—Ü—ã –ø–æ–≥–∏–±–ª–∏! –ò–≥—Ä–∞ –Ω–∞—á–Ω—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ.');
                showMainMenu();
                gameState.gameStarted = false;
                saveGame();
                return;
            }
            
            saveGame();
        }
        
        function dividePet(parentPet) {
            // –°–æ–∑–¥–∞—ë–º –¥–≤—É—Ö –Ω–æ–≤—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–¥–∏—Ç–µ–ª—è
            const child1 = {
                id: Date.now().toString(),
                name: `${parentPet.name}-1`,
                hunger: MAX_HUNGER,
                energy: MAX_ENERGY,
                happiness: MAX_HAPPINESS,
                level: 1,
                lastFed: Date.now(),
                lastRested: Date.now(),
                lastPlayed: Date.now(),
                createdAt: Date.now()
            };
            
            const child2 = {
                id: (Date.now() + 1).toString(),
                name: `${parentPet.name}-2`,
                hunger: MAX_HUNGER,
                energy: MAX_ENERGY,
                happiness: MAX_HAPPINESS,
                level: 1,
                lastFed: Date.now(),
                lastRested: Date.now(),
                lastPlayed: Date.now(),
                createdAt: Date.now()
            };
            
            // –£–¥–∞–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –∏ –¥–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–π
            gameState.pets = gameState.pets.filter(pet => pet.id !== parentPet.id);
            gameState.pets.push(child1, child2);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–ª–µ–Ω–∏–∏
            const notice = document.createElement('div');
            notice.className = 'evolution-notice';
            notice.textContent = `${parentPet.name} –¥–æ—Å—Ç–∏–≥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏ —Ä–∞–∑–¥–µ–ª–∏–ª—Å—è –Ω–∞ ${child1.name} –∏ ${child2.name}!`;
            petsContainer.prepend(notice);
            
            // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                notice.remove();
            }, 5000);
        }
        
        function renderPets() {
            petsContainer.innerHTML = '';
            
            if (gameState.pets.length === 0) {
                const noPetsMsg = document.createElement('p');
                noPetsMsg.textContent = '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤.';
                petsContainer.appendChild(noPetsMsg);
                return;
            }
            
            for (let pet of gameState.pets) {
                const petElement = document.createElement('div');
                petElement.className = 'pet';
                petElement.dataset.id = pet.id;
                
                const petStatus = getPetStatus(pet);
                
                petElement.innerHTML = `
                    <div class="pet-name">${pet.name} (${petStatus})</div>
                    <div class="pet-stats">
                        <div>–ì–æ–ª–æ–¥: ${Math.round(pet.hunger)}/${MAX_HUNGER}</div>
                        <div class="progress-container">
                            <div class="progress-bar hunger" style="width: ${(pet.hunger / MAX_HUNGER) * 100}%"></div>
                        </div>
                        
                        <div>–≠–Ω–µ—Ä–≥–∏—è: ${Math.round(pet.energy)}/${MAX_ENERGY}</div>
                        <div class="progress-container">
                            <div class="progress-bar energy" style="width: ${(pet.energy / MAX_ENERGY) * 100}%"></div>
                        </div>
                        
                        <div>–°—á–∞—Å—Ç—å–µ: ${Math.round(pet.happiness)}/${MAX_HAPPINESS}</div>
                        <div class="progress-container">
                            <div class="progress-bar happiness" style="width: ${(pet.happiness / MAX_HAPPINESS) * 100}%"></div>
                        </div>
                        
                        <div>–£—Ä–æ–≤–µ–Ω—å: ${Math.round(pet.level * 10) / 10}/${MAX_LEVEL}</div>
                        <div class="progress-container">
                            <div class="progress-bar level" style="width: ${(pet.level / MAX_LEVEL) * 100}%"></div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="feed-btn" ${pet.hunger >= MAX_HUNGER ? 'disabled' : ''}>–ü–æ–∫–æ—Ä–º–∏—Ç—å</button>
                        <button class="rest-btn" ${pet.energy >= MAX_ENERGY ? 'disabled' : ''}>–û—Ç–¥—ã—Ö</button>
                        <button class="play-btn" ${pet.happiness >= MAX_HAPPINESS ? 'disabled' : ''}>–ü–æ–∏–≥—Ä–∞—Ç—å</button>
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                petElement.querySelector('.feed-btn').addEventListener('click', () => feedPet(pet.id));
                petElement.querySelector('.rest-btn').addEventListener('click', () => restPet(pet.id));
                petElement.querySelector('.play-btn').addEventListener('click', () => playWithPet(pet.id));
                
                petsContainer.appendChild(petElement);
            }
        }
        
        function getPetStatus(pet) {
            if (pet.hunger <= 20 || pet.energy <= 15 || pet.happiness <= 10) {
                return 'üíÄ –£–º–∏—Ä–∞–µ—Ç';
            } else if (pet.hunger <= 40 || pet.energy <= 30 || pet.happiness <= 25) {
                return 'üòü –ü–ª–æ—Ö–æ';
            } else if (pet.hunger <= 70 || pet.energy <= 60 || pet.happiness <= 50) {
                return 'üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ';
            } else if (pet.level >= MAX_LEVEL * 0.8) {
                return '‚ö° –ì–æ—Ç–æ–≤ –∫ –¥–µ–ª–µ–Ω–∏—é';
            } else {
                return 'üòä –û—Ç–ª–∏—á–Ω–æ';
            }
        }
        
        function feedPet(petId) {
            const pet = gameState.pets.find(p => p.id === petId);
            if (pet) {
                pet.hunger = Math.min(MAX_HUNGER, pet.hunger + FEED_AMOUNT);
                pet.lastFed = Date.now();
                saveGame();
                updateGame();
                renderPets();
            }
        }
        
        function restPet(petId) {
            const pet = gameState.pets.find(p => p.id === petId);
            if (pet) {
                pet.energy = Math.min(MAX_ENERGY, pet.energy + REST_AMOUNT);
                pet.lastRested = Date.now();
                saveGame();
                updateGame();
                renderPets();
            }
        }
        
        function playWithPet(petId) {
            const pet = gameState.pets.find(p => p.id === petId);
            if (pet) {
                pet.happiness = Math.min(MAX_HAPPINESS, pet.happiness + PLAY_AMOUNT);
                pet.lastPlayed = Date.now();
                saveGame();
                updateGame();
                renderPets();
            }
        }
        
        function startGameLoop() {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ü–∏–∫–ª, –µ—Å–ª–∏ –æ–Ω –±—ã–ª
            if (window.gameLoop) {
                clearInterval(window.gameLoop);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥)
            window.gameLoop = setInterval(() => {
                updateGame();
                renderPets();
            }, 5000);
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã
        function saveGame() {
            localStorage.setItem('evolutionTamagotchi', JSON.stringify(gameState));
        }
        
        function loadGame() {
            const savedGame = localStorage.getItem('evolutionTamagotchi');
            if (savedGame) {
                try {
                    const parsed = JSON.parse(savedGame);
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                    if (parsed.pets && Array.isArray(parsed.pets)) {
                        gameState = parsed;
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã:', e);
                }
            }
        }
    </script>
</body>
</html>