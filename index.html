<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Space Cow Hunt</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #0d0f2e;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      height: 100vh;
    }
    canvas {
      display: block;
      background: linear-gradient(#0d0f2e, #1c1f4a);
      width: 100%;
      height: 100%;
    }
    #menu {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: rgba(0,0,0,0.7);
      z-index: 2;
    }
    #menu button {
      padding: 1em 2em;
      font-size: 1.5em;
      border: none;
      border-radius: 10px;
      background: #4a90e2;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="menu">
    <h1>üõ∏ Space Cow Hunt üõ∏</h1>
    <button onclick="startGame()">Start Game</button>
  </div>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let width = window.innerWidth;
    let height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;

    window.addEventListener('resize', () => {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
    });

    // === GAME STATE ===
    let gameRunning = false;
    let cows = [];
    let particles = [];
    let score = 0;
    let spawnTimer = 0;
    let direction = 1; // 1 - right, -1 - left

    function startGame() {
      document.getElementById("menu").style.display = "none";
      gameRunning = true;
      cows = [];
      particles = [];
      score = 0;
      spawnTimer = 0;
      direction = 1;
      loop();
    }

    class Cow {
      constructor() {
        this.size = Math.random() * 30 + 30;
        this.x = Math.random() > 0.5 ? -this.size : width + this.size;
        this.y = Math.random() * (height / 2);
        this.vx = (Math.random() * 1 + 1) * direction;
        this.vy = 0;
        this.dead = false;
        this.fallSpeed = 0;
        this.rotation = 0;
      }

      update() {
        if (!this.dead) {
          this.x += this.vx;
          this.y += this.vy;
          if ((this.x > width + this.size || this.x < -this.size) && !this.dead) {
            this.respawn();
          }
        } else {
          this.fallSpeed += 0.3;
          this.y += this.fallSpeed;
          this.rotation += 0.1;
        }
      }

      draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation);

        // Body
        ctx.fillStyle = "#666";
        ctx.beginPath();
        ctx.ellipse(0, 0, this.size / 1.5, this.size, 0, 0, Math.PI * 2);
        ctx.fill();

        // Head
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(0, -this.size * 0.8, this.size * 0.4, 0, Math.PI * 2);
        ctx.fill();

        // Helmet
        ctx.strokeStyle = "#00ffff88";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(0, -this.size * 0.8, this.size * 0.4, 0, Math.PI * 2);
        ctx.stroke();

        // Horns
        ctx.fillStyle = "#ffcc00";
        ctx.beginPath();
        ctx.moveTo(-this.size * 0.3, -this.size * 1.2);
        ctx.lineTo(-this.size * 0.2, -this.size * 1.6);
        ctx.lineTo(-this.size * 0.1, -this.size * 1.2);
        ctx.fill();
        ctx.beginPath();
        ctx.moveTo(this.size * 0.3, -this.size * 1.2);
        ctx.lineTo(this.size * 0.2, -this.size * 1.6);
        ctx.lineTo(this.size * 0.1, -this.size * 1.2);
        ctx.fill();

        // Eyes
        ctx.fillStyle = "#00ffff";
        ctx.beginPath();
        ctx.ellipse(-this.size * 0.15, -this.size * 0.85, this.size * 0.1, this.size * 0.15, 0, 0, Math.PI * 2);
        ctx.fill();
        ctx.beginPath();
        ctx.ellipse(this.size * 0.15, -this.size * 0.85, this.size * 0.1, this.size * 0.15, 0, 0, Math.PI * 2);
        ctx.fill();

        // Nose
        ctx.fillStyle = "#a0522d";
        ctx.beginPath();
        ctx.roundRect(this.size * -0.1, -this.size * 0.7, this.size * 0.2, this.size * 0.1, 5);
        ctx.fill();
        ctx.fillStyle = "black";
        ctx.beginPath();
        ctx.arc(-this.size * 0.05, -this.size * 0.65, 2, 0, Math.PI * 2);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(this.size * 0.05, -this.size * 0.65, 2, 0, Math.PI * 2);
        ctx.fill();

        // Legs
        ctx.fillStyle = "#666";
        for (let i = 0; i < 4; i++) {
          let legX = (-this.size / 2) + (i % 2 ? this.size / 2 : 0);
          let legY = this.size * 0.3;
          ctx.fillRect(legX, legY, this.size * 0.1, this.size * 0.2);
        }

        // Wings
        ctx.fillStyle = "#444";
        ctx.beginPath();
        ctx.moveTo(-this.size * 0.8, -this.size * 0.2);
        ctx.lineTo(-this.size * 1.2, -this.size * 0.5);
        ctx.lineTo(-this.size * 0.8, this.size * 0.3);
        ctx.closePath();
        ctx.fill();
        ctx.beginPath();
        ctx.moveTo(this.size * 0.8, -this.size * 0.2);
        ctx.lineTo(this.size * 1.2, -this.size * 0.5);
        ctx.lineTo(this.size * 0.8, this.size * 0.3);
        ctx.closePath();
        ctx.fill();

        ctx.restore();
      }

      isHit(mx, my) {
        return Math.hypot(this.x - mx, this.y - my) < this.size;
      }

      die() {
        this.dead = true;
        this.vx = 0;
        this.vy = 0;
        createExplosion(this.x, this.y);
        score++;
      }

      respawn() {
        this.x = Math.random() > 0.5 ? -this.size : width + this.size;
        this.y = Math.random() * (height / 2);
        this.vx = (Math.random() * 1 + 1) * (this.x < 0 ? 1 : -1);
        this.dead = false;
        this.fallSpeed = 0;
        this.rotation = 0;
      }
    }

    class Particle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 6;
        this.vy = (Math.random() - 0.5) * 6;
        this.life = 30;
        this.color = `hsl(${Math.random() * 360}, 100%, 70%)`;
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.life--;
      }

      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function createExplosion(x, y) {
      for (let i = 0; i < 20; i++) {
        particles.push(new Particle(x, y));
      }
    }

    function loop() {
      if (!gameRunning) return;

      ctx.clearRect(0, 0, width, height);

      spawnTimer++;
      if (spawnTimer > 60) {
        cows.push(new Cow());
        spawnTimer = 0;
      }

      for (let cow of cows) {
        cow.update();
        cow.draw();
      }

      for (let p of particles) {
        p.update();
        p.draw();
      }

      particles = particles.filter(p => p.life > 0);

      ctx.fillStyle = "#fff";
      ctx.font = "24px sans-serif";
      ctx.fillText("Score: " + score, 20, 40);

      requestAnimationFrame(loop);
    }

    canvas.addEventListener("click", e => {
      if (!gameRunning) return;
      const rect = canvas.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;
      for (let cow of cows) {
        if (!cow.dead && cow.isHit(mx, my)) {
          cow.die();
        }
      }
    });

    // Polyfill –¥–ª—è roundRect
    (function(ctx){
      ctx.roundRect = function (x, y, w, h, r) {
        if (w < 2 * r) r = w / 2;
        if (h < 2 * r) r = h / 2;
        this.beginPath();
        this.moveTo(x + r, y);
        this.arcTo(x + w, y, x + w, y + h, r);
        this.arcTo(x + w, y + h, x, y + h, r);
        this.arcTo(x, y + h, x, y, r);
        this.arcTo(x, y, x + w, y, r);
        this.closePath();
        return this;
      };
    })(CanvasRenderingContext2D.prototype);
  </script>
</body>
</html>