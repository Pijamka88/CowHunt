<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Winged Cows Hunt</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #0a0f2c;
      font-family: sans-serif;
    }
    canvas {
      display: block;
      background: linear-gradient(#0a0f2c, #1e1e4c);
      width: 100vw;
      height: 100vh;
    }
    #menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: white;
    }
    #playBtn {
      padding: 20px 40px;
      font-size: 24px;
      border: none;
      border-radius: 10px;
      background: #3b82f6;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    #playBtn:hover {
      background: #2563eb;
    }
  </style>
</head>
<body>
<div id="menu">
  <h1>Winged Cows Hunt</h1>
  <button id="playBtn">Играть</button>
</div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let width, height;
function resize() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// === ГЛАВНОЕ МЕНЮ ===
const menu = document.getElementById("menu");
const playBtn = document.getElementById("playBtn");
playBtn.onclick = () => {
  menu.style.display = "none";
  startGame();
};

// === ИГРОВАЯ ЛОГИКА ===
let cows = [];
let particles = [];
let score = 0;
let gameRunning = false;

class Cow {
  constructor() {
    this.reset();
  }

  reset() {
    this.size = Math.random() * 40 + 30;
    this.x = Math.random() < 0.5 ? -this.size : width + this.size;
    this.y = Math.random() * (height * 0.7) + 50;
    this.vx = (Math.random() * 2 + 1) * (this.x < 0 ? 1 : -1);
    this.vy = (Math.random() - 0.5) * 1;
    this.dead = false;
    this.fallSpeed = 0;
  }

  update() {
    if (!this.dead) {
      this.x += this.vx;
      this.y += this.vy;
      if ((this.vx > 0 && this.x > width + this.size) || (this.vx < 0 && this.x < -this.size)) {
        this.reset();
      }
    } else {
      this.y += this.fallSpeed;
      this.fallSpeed += 0.3;
      if (this.y > height + this.size) {
        this.reset();
      }
    }
  }

  draw(ctx) {
    ctx.save();
    ctx.translate(this.x, this.y);
    const scale = this.size / 50;
    ctx.scale(scale, scale);

    // Тело
    ctx.fillStyle = "#8B4513"; // коричневое
    ctx.beginPath();
    ctx.ellipse(0, 0, 25, 40, 0, 0, Math.PI * 2);
    ctx.fill();

    // Шлем
    ctx.fillStyle = "#aaaaff88";
    ctx.beginPath();
    ctx.arc(0, -35, 15, 0, Math.PI * 2);
    ctx.fill();

    // Рожки
    ctx.strokeStyle = "#ffdd00";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(-10, -45);
    ctx.lineTo(-20, -65);
    ctx.moveTo(10, -45);
    ctx.lineTo(20, -65);
    ctx.stroke();

    // Глаза
    ctx.fillStyle = "white";
    ctx.beginPath();
    ctx.arc(-10, -10, 7, 0, Math.PI * 2);
    ctx.arc(10, -10, 7, 0, Math.PI * 2);
    ctx.fill();

    // Зрачки
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(-10, -10, 3, 0, Math.PI * 2);
    ctx.arc(10, -10, 3, 0, Math.PI * 2);
    ctx.fill();

    // Нос
    ctx.fillStyle = "#8B0000";
    ctx.beginPath();
    ctx.arc(0, 10, 5, 0, Math.PI * 2);
    ctx.fill();

    // Ноздри
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(-2, 10, 1.5, 0, Math.PI * 2);
    ctx.arc(2, 10, 1.5, 0, Math.PI * 2);
    ctx.fill();

    ctx.restore();
  }

  isHit(x, y) {
    return !this.dead && Math.hypot(this.x - x, this.y - y) < this.size;
  }
}

class Particle {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.vx = (Math.random() - 0.5) * 6;
    this.vy = (Math.random() - 0.5) * 6;
    this.life = 30;
    this.color = ["#ffffff", "#aaaaff", "#ffcc00"][Math.floor(Math.random() * 3)];
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.life--;
  }

  draw(ctx) {
    ctx.fillStyle = this.color;
    ctx.globalAlpha = this.life / 30;
    ctx.fillRect(this.x, this.y, 3, 3);
    ctx.globalAlpha = 1;
  }
}

function spawnCows() {
  while (cows.length < 5) {
    cows.push(new Cow());
  }
}

function update() {
  if (!gameRunning) return;

  ctx.clearRect(0, 0, width, height);

  // Звезды
  ctx.fillStyle = "white";
  for (let i = 0; i < 100; i++) {
    ctx.fillRect(Math.random() * width, Math.random() * height, 1, 1);
  }

  // Обновление объектов
  spawnCows();
  particles.forEach(p => p.update());
  particles = particles.filter(p => p.life > 0);
  cows.forEach(c => c.update());

  // Отрисовка
  particles.forEach(p => p.draw(ctx));
  cows.forEach(c => c.draw(ctx));

  // Счет
  ctx.fillStyle = "white";
  ctx.font = "24px sans-serif";
  ctx.fillText("Счёт: " + score, 20, 40);

  requestAnimationFrame(update);
}

function shoot(x, y) {
  for (let cow of cows) {
    if (cow.isHit(x, y)) {
      cow.dead = true;
      cow.fallSpeed = 1;
      score++;
      createExplosion(x, y);
    }
  }
}

function createExplosion(x, y) {
  for (let i = 0; i < 30; i++) {
    particles.push(new Particle(x, y));
  }
}

// === Управление ===
canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  const rect = canvas.getBoundingClientRect();
  shoot(touch.clientX - rect.left, touch.clientY - rect.top);
});

canvas.addEventListener("mousedown", e => {
  const rect = canvas.getBoundingClientRect();
  shoot(e.clientX - rect.left, e.clientY - rect.top);
});

// === Запуск игры ===
function startGame() {
  score = 0;
  cows = [];
  particles = [];
  gameRunning = true;
  update();
}
</script>
</body>
</html>